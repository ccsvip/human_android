# Human Android é¡¹ç›®è¯´æ˜æ–‡æ¡£

> æ–‡æ¡£ç”Ÿæˆæ—¶é—´: 2025-10-02
> SDKç‰ˆæœ¬: v4.1.1
> æ–‡æ¡£ç‰ˆæœ¬: 2.0.0
> åŸºäº Repomix ä»£ç åº“åˆ†æç”Ÿæˆ

---

## ğŸ“‹ ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [é¡¹ç›®æ¶æ„](#é¡¹ç›®æ¶æ„)
3. [ç›®å½•ç»“æ„](#ç›®å½•ç»“æ„)
4. [ç¨‹åºå…¥å£ç‚¹](#ç¨‹åºå…¥å£ç‚¹)
5. [ä¾èµ–å…³ç³»åˆ†æ](#ä¾èµ–å…³ç³»åˆ†æ)
6. [æ ¸å¿ƒæ¨¡å—è¯´æ˜](#æ ¸å¿ƒæ¨¡å—è¯´æ˜)
7. [æ–‡ä»¶åŠŸèƒ½è¯´æ˜](#æ–‡ä»¶åŠŸèƒ½è¯´æ˜)
8. [å›½é™…åŒ–ç³»ç»Ÿ](#å›½é™…åŒ–ç³»ç»Ÿ)
9. [ç›®å½•è§£è€¦åˆ†æ](#ç›®å½•è§£è€¦åˆ†æ)
10. [å¾…å®Œæˆäº‹é¡¹(TODO)](#å¾…å®Œæˆäº‹é¡¹todo)
11. [æŠ€æœ¯æ ˆ](#æŠ€æœ¯æ ˆ)
12. [æ„å»ºä¸éƒ¨ç½²](#æ„å»ºä¸éƒ¨ç½²)
13. [é™„å½•](#é™„å½•)
14. [æ›´æ–°æ—¥å¿—](#æ›´æ–°æ—¥å¿—)

---

## é¡¹ç›®æ¦‚è¿°

**Human Android** æ˜¯ä¸€ä¸ªåŸºäºAndroidå¹³å°çš„2Dè™šæ‹Ÿæ•°å­—äººSDKé¡¹ç›®ï¼Œæä¾›è½»é‡çº§ã€çº¯ç¦»çº¿çš„æ•°å­—äººè§£å†³æ–¹æ¡ˆã€‚é¡¹ç›®æ”¯æŒé€šè¿‡è¯­éŸ³éŸ³é¢‘é©±åŠ¨æ•°å­—äººå½¢è±¡å¹¶è¿›è¡Œå®æ—¶æ¸²æŸ“ï¼Œé€‚ç”¨äºç§»åŠ¨ç«¯çš„è™šæ‹ŸåŠ©æ‰‹ã€è™šæ‹Ÿä¸»æ’­ç­‰åº”ç”¨åœºæ™¯ã€‚

### æ ¸å¿ƒç‰¹æ€§

- âœ… **çº¯ç¦»çº¿è¿è¡Œ** - æ‰€æœ‰AIæ¨ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œæ— éœ€ç½‘ç»œè¿æ¥
- âœ… **å®æ—¶æ¸²æŸ“** - åŸºäºOpenGL ESçš„é«˜æ€§èƒ½2Dæ¸²æŸ“å¼•æ“
- âœ… **éŸ³é¢‘é©±åŠ¨** - æ”¯æŒPCMæµå’ŒWAVæ–‡ä»¶é©±åŠ¨å£å‹åŠ¨ç”»
- âœ… **åŠ¨ä½œæ§åˆ¶** - æ”¯æŒé¢„å®šä¹‰åŠ¨ä½œå’ŒéšæœºåŠ¨ä½œæ’­æ”¾
- âœ… **æ¨¡å‹ç®¡ç†** - å®Œæ•´çš„æ¨¡å‹ä¸‹è½½ã€è§£å‹ã€æ ¡éªŒæœºåˆ¶
- âœ… **åŒæ¨¡å¼æ”¯æŒ** - æ”¯æŒæœ¬åœ°æ¨¡å¼å’Œäº‘ç«¯æ¨¡å¼ï¼ˆäº‘ç«¯å¾…å¼€å‘ï¼‰
- âœ… **å›½é™…åŒ–æ”¯æŒ** - å®Œæ•´çš„ä¸­è‹±æ–‡åŒè¯­ç³»ç»Ÿï¼ˆ2025-10-02æ–°å¢ï¼‰
- âœ… **ç°ä»£åŒ–UI** - WebView + Tailwind CSSå“åº”å¼è®¾è®¡

### ç³»ç»Ÿè¦æ±‚

- **æœ€ä½SDKç‰ˆæœ¬**: Android 7.0 (API 24)
- **ç›®æ ‡SDKç‰ˆæœ¬**: Android 13/14 (API 33/34)
- **æ¨èç¡¬ä»¶**:
  - CPU: 8æ ¸åŠä»¥ä¸Šï¼ˆæ¨èéªé¾™8 Gen2ï¼‰
  - å†…å­˜: 8GBåŠä»¥ä¸Š
  - å­˜å‚¨: 1GBå¯ç”¨ç©ºé—´
  - æ”¯æŒæ¶æ„: arm64-v8a, armeabi-v7a

---

## é¡¹ç›®æ¶æ„

### æ¨¡å—åˆ’åˆ†

é¡¹ç›®é‡‡ç”¨**æ¨¡å—åŒ–æ¶æ„è®¾è®¡**ï¼Œç”±ä¸¤ä¸ªä¸»è¦æ¨¡å—ç»„æˆï¼š

```
human_android/
â”œâ”€â”€ duix-sdk/          # æ ¸å¿ƒSDKåº“æ¨¡å—ï¼ˆå¯ç‹¬ç«‹å‘å¸ƒçš„AARï¼‰
â””â”€â”€ test/              # ç¤ºä¾‹åº”ç”¨æ¨¡å—ï¼ˆå±•ç¤ºSDKç”¨æ³•ï¼‰
```

### æ¶æ„åˆ†å±‚

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Application Layer               â”‚  (testæ¨¡å—)
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   MainActivity (è·¯ç”±)            â”‚  â”‚
â”‚   â”‚   â”œâ”€ WelcomeActivity (æ¬¢è¿é¡µ)   â”‚  â”‚
â”‚   â”‚   â”œâ”€ LocalMainActivity (æœ¬åœ°)   â”‚  â”‚
â”‚   â”‚   â”‚   â””â”€ LocalCallActivity      â”‚  â”‚
â”‚   â”‚   â””â”€ CloudMainActivity (äº‘ç«¯)   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          SDK Layer                      â”‚  (duix-sdkæ¨¡å—)
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   DUIX (ä¸»æ§ç±»)                 â”‚  â”‚
â”‚   â”‚   â”œâ”€ DUIXInitializer           â”‚  â”‚
â”‚   â”‚   â”œâ”€ DUIXAudioController       â”‚  â”‚
â”‚   â”‚   â””â”€ DUIXMotionController      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â†“           â†“              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ RenderThread â”‚  â”‚ AudioPlayer â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚              â†“                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   DUIXRenderer (OpenGLæ¸²æŸ“)     â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ LanguageManager (å›½é™…åŒ–)        â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                         â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ WelcomeActivity (æ¬¢è¿é¡µ)        â”‚  â”‚
â”‚   â”‚   â”œâ”€ welcome.html               â”‚  â”‚
â”‚   â”‚   â”œâ”€ i18n.js (å›½é™…åŒ–)           â”‚  â”‚
â”‚   â”‚   â””â”€ welcome.js                 â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Native Layer (JNI)               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   gjduix.so (C++ Nativeåº“)      â”‚  â”‚
â”‚   â”‚   â”œâ”€ gjduix.cpp (ä¸»æ§é€»è¾‘)      â”‚  â”‚
â”‚   â”‚   â””â”€ gjsimp.cpp (ç®€åŒ–æ¥å£)      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚              â†“           â†“              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚   dhunet     â”‚  â”‚   dhmfcc    â”‚   â”‚
â”‚   â”‚ (AIæ¨ç†æ¨¡å—) â”‚  â”‚ (éŸ³é¢‘ç‰¹å¾)  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Third-Party Libraries              â”‚
â”‚   - NCNN (ç¥ç»ç½‘ç»œæ¨ç†)                 â”‚
â”‚   - OpenCV (å›¾åƒå¤„ç†)                   â”‚
â”‚   - ONNX Runtime (æ¨¡å‹è¿è¡Œæ—¶)           â”‚
â”‚   - TurboJPEG (å›¾åƒç¼–è§£ç )              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ç›®å½•ç»“æ„

### å®Œæ•´ç›®å½•æ ‘

```
human_android/
â”œâ”€â”€ .git/                               # Gitç‰ˆæœ¬æ§åˆ¶
â”œâ”€â”€ .mcp.json                           # MCPé…ç½®æ–‡ä»¶
â”œâ”€â”€ .claudeignore                       # Claudeå¿½ç•¥é…ç½®
â”œâ”€â”€ CLAUDE.md                           # ClaudeæŒ‡ä»¤æ–‡æ¡£
â”œâ”€â”€ AGENTS.md                           # AgentæŒ‡ä»¤æ–‡æ¡£
â”œâ”€â”€ README.md                           # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ build.gradle                        # æ ¹çº§æ„å»ºé…ç½®
â”œâ”€â”€ settings.gradle                     # æ¨¡å—é…ç½®
â”œâ”€â”€ gradle.properties                   # Gradleå±æ€§
â”œâ”€â”€ gradlew                             # GradleåŒ…è£…è„šæœ¬
â”œâ”€â”€ android_glide_lint.xml              # Glide Linté…ç½®
â”œâ”€â”€ demo.jks                            # ç­¾åæ–‡ä»¶ï¼ˆç¤ºä¾‹ï¼‰
â”‚
â”œâ”€â”€ docs/                               # ğŸ“ é¡¹ç›®æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ ç¼–è¯‘é”™è¯¯ä¿®å¤-2025-09-29.md
â”‚   â”œâ”€â”€ æ¬¢è¿é¡µé¢åŠŸèƒ½å®ç°-2025-09-29.md
â”‚   â”œâ”€â”€ æ¬¢è¿é¡µé¢ä¸“ä¸šç¾åŒ–å®ç°-2025-09-30.md
â”‚   â”œâ”€â”€ æ•°å­—äººåœæ­¢æ’­æ”¾æŒ‰é’®è®¾è®¡åˆ†æ-2025-09-30.md
â”‚   â”œâ”€â”€ å®¶åº­ç¯å¢ƒç¼–è¯‘é…ç½®-2025-10-01.md
â”‚   â”œâ”€â”€ æ¬¢è¿é¡µé¢ç•Œé¢ç¾åŒ–-2025-10-02.md
â”‚   â”œâ”€â”€ æ¬¢è¿é¡µé¢ä¼˜åŒ–-Logoå’ŒåŠ¨ç”»å¢å¼º-2025-10-02.md
â”‚   â”œâ”€â”€ æ¶æ„é‡æ„-æœ¬åœ°äº‘ç«¯åˆ†ç¦»-2025-10-02.md
â”‚   â”œâ”€â”€ è¿”å›æŒ‰é’®ä½ç½®ä¼˜åŒ–-æ¨¡å—åŒ–è®¾è®¡-2025-10-02.md
â”‚   â”œâ”€â”€ æœ¬åœ°æ•°å­—äººç•Œé¢æ¨¡å—åŒ–æ”¹é€ -2025-10-02.md
â”‚   â”œâ”€â”€ Gradleå†…å­˜é…ç½®ä¼˜åŒ–-2025-10-02.md
â”‚   â”œâ”€â”€ DUIXè§£è€¦é‡æ„-2025-10-02.md
â”‚   â”œâ”€â”€ åº”ç”¨é—ªé€€é—®é¢˜ä¿®å¤-2025-10-02.md
â”‚   â”œâ”€â”€ å®ç°å®Œæ•´çš„å›½é™…åŒ–ç³»ç»Ÿ-2025-10-02.md
â”‚   â”œâ”€â”€ å›½é™…åŒ–åŠŸèƒ½å®ç°-2025-10-02.md
â”‚   â”œâ”€â”€ è¯­è¨€åˆ‡æ¢åŠŸèƒ½ä¿®å¤-2025-10-02.md
â”‚   â””â”€â”€ æ¬¢è¿é¡µæ ‡é¢˜ä¼˜åŒ–å’Œä¸‹æ‹‰èœå•ä½ç½®ä¿®å¤-2025-10-02.md
â”‚
â”œâ”€â”€ duix-sdk/                           # ========== æ ¸å¿ƒSDKæ¨¡å— ==========
â”‚   â”œâ”€â”€ build.gradle                    # SDKæ„å»ºé…ç½®
â”‚   â”œâ”€â”€ proguard-rules.pro              # æ··æ·†è§„åˆ™
â”‚   â”œâ”€â”€ .gitignore
â”‚   â”‚
â”‚   â””â”€â”€ src/main/
â”‚       â”œâ”€â”€ AndroidManifest.xml         # SDKæ¸…å•æ–‡ä»¶
â”‚       â”‚
â”‚       â”œâ”€â”€ assets/                     # èµ„æºæ–‡ä»¶
â”‚       â”‚   â””â”€â”€ welcome/                # æ¬¢è¿é¡µé¢èµ„æº
â”‚       â”‚       â”œâ”€â”€ welcome.html        # æ¬¢è¿é¡µHTMLï¼ˆç°ä»£åŒ–è®¾è®¡ï¼‰
â”‚       â”‚       â”œâ”€â”€ js/
â”‚       â”‚       â”‚   â”œâ”€â”€ welcome.js      # æ¬¢è¿é¡µè„šæœ¬
â”‚       â”‚       â”‚   â””â”€â”€ i18n.js         # å›½é™…åŒ–è„šæœ¬ï¼ˆ2025-10-02æ–°å¢ï¼‰
â”‚       â”‚       â””â”€â”€ css/
â”‚       â”‚           â”œâ”€â”€ tailwind.min.css # Tailwind CSS
â”‚       â”‚           â””â”€â”€ welcome.css      # æ¬¢è¿é¡µæ ·å¼
â”‚       â”‚
â”‚       â”œâ”€â”€ java/ai/guiji/duix/         # Java/Kotlinæºç 
â”‚       â”‚   â”‚
â”‚       â”‚   â”œâ”€â”€ DuixNcnn.java           # JNIæ¥å£å£°æ˜
â”‚       â”‚   â”‚
â”‚       â”‚   â””â”€â”€ sdk/
â”‚       â”‚       â”œâ”€â”€ client/             # ========== SDKå®¢æˆ·ç«¯åŒ… ==========
â”‚       â”‚       â”‚   â”œâ”€â”€ DUIX.java                   # â­ æ ¸å¿ƒä¸»æ§ç±»
â”‚       â”‚       â”‚   â”œâ”€â”€ Callback.java               # äº‹ä»¶å›è°ƒæ¥å£
â”‚       â”‚       â”‚   â”œâ”€â”€ Constant.java               # å¸¸é‡å®šä¹‰
â”‚       â”‚       â”‚   â”œâ”€â”€ VirtualModelUtil.java       # æ¨¡å‹å·¥å…·ç±»
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ audio/                      # éŸ³é¢‘æ¨¡å—
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ AudioPlayer.java        # éŸ³é¢‘æ’­æ”¾å™¨
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ bean/                       # æ•°æ®æ¨¡å‹
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ AudioFrame.java         # éŸ³é¢‘å¸§
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ ImageFrame.java         # å›¾åƒå¸§
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ controller/                 # æ§åˆ¶å™¨ï¼ˆ2025-10-02æ–°å¢ï¼‰
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ DUIXAudioController.java    # éŸ³é¢‘æ§åˆ¶å™¨
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ DUIXInitializer.java        # åˆå§‹åŒ–å™¨
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ DUIXMotionController.java   # åŠ¨ä½œæ§åˆ¶å™¨
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ loader/                     # åŠ è½½å™¨
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ ModelInfo.java          # æ¨¡å‹ä¿¡æ¯
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ ModelInfoLoader.java    # æ¨¡å‹ä¿¡æ¯åŠ è½½å™¨
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ net/                        # ç½‘ç»œæ¨¡å—
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ FileDownloader.java     # æ–‡ä»¶ä¸‹è½½å™¨
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ DownloadZipService.java # ZIPä¸‹è½½æœåŠ¡
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ render/                     # â­ æ¸²æŸ“æ¨¡å—
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ DUIXRenderer.java       # OpenGLæ¸²æŸ“å™¨
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ DUIXTextureView.java    # çº¹ç†è§†å›¾
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ ImageDrawer.java        # å›¾åƒç»˜åˆ¶å™¨
â”‚       â”‚       â”‚   â”‚   â”œâ”€â”€ TextureMatrix.java      # çº¹ç†çŸ©é˜µ
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ RenderSink.java         # æ¸²æŸ“æ¥æ”¶å™¨æ¥å£
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â”œâ”€â”€ thread/                     # çº¿ç¨‹æ¨¡å—
â”‚       â”‚       â”‚   â”‚   â””â”€â”€ RenderThread.java       # â­ æ¸²æŸ“çº¿ç¨‹
â”‚       â”‚       â”‚   â”‚
â”‚       â”‚       â”‚   â””â”€â”€ util/                       # å·¥å…·ç±»
â”‚       â”‚       â”‚       â”œâ”€â”€ DeviceUtils.java        # è®¾å¤‡å·¥å…·
â”‚       â”‚       â”‚       â”œâ”€â”€ FileUtil.java           # æ–‡ä»¶å·¥å…·
â”‚       â”‚       â”‚       â”œâ”€â”€ Logger.java             # æ—¥å¿—å·¥å…·
â”‚       â”‚       â”‚       â”œâ”€â”€ MD5Util.java            # MD5å·¥å…·
â”‚       â”‚       â”‚       â”œâ”€â”€ OpenGLUtil.java         # OpenGLå·¥å…·
â”‚       â”‚       â”‚       â”œâ”€â”€ SystemUtils.java        # ç³»ç»Ÿå·¥å…·
â”‚       â”‚       â”‚       â””â”€â”€ ZipUtil.java            # ZIPå·¥å…·
â”‚       â”‚       â”‚
â”‚       â”‚       â”œâ”€â”€ i18n/                # å›½é™…åŒ–æ¨¡å—ï¼ˆ2025-10-02æ–°å¢ï¼‰
â”‚       â”‚       â”‚   â””â”€â”€ LanguageManager.kt          # è¯­è¨€ç®¡ç†å™¨
â”‚       â”‚       â”‚
â”‚       â”‚       â””â”€â”€ welcome/            # æ¬¢è¿é¡µé¢æ¨¡å—
â”‚       â”‚           â”œâ”€â”€ WelcomeActivity.kt          # æ¬¢è¿é¡µActivity
â”‚       â”‚           â”œâ”€â”€ WelcomeConfig.kt            # æ¬¢è¿é¡µé…ç½®
â”‚       â”‚           â””â”€â”€ WelcomeIntegrationExample.kt # é›†æˆç¤ºä¾‹
â”‚       â”‚
â”‚       â””â”€â”€ cpp/                        # ========== C++ Nativeä»£ç  ==========
â”‚           â”œâ”€â”€ CMakeLists.txt          # â­ CMakeæ„å»ºè„šæœ¬
â”‚           â”‚
â”‚           â”œâ”€â”€ include/                # å…¬å…±å¤´æ–‡ä»¶
â”‚           â”‚   â”œâ”€â”€ gjduix.h            # DUIXä¸»æ¥å£
â”‚           â”‚   â”œâ”€â”€ gjsimp.h            # ç®€åŒ–æ¥å£
â”‚           â”‚   â”œâ”€â”€ dhextend.h          # æ‰©å±•æ¥å£
â”‚           â”‚   â”œâ”€â”€ dhextctrl.h         # æ§åˆ¶æ¥å£
â”‚           â”‚   â”œâ”€â”€ dhextinc.h          # åŒ…å«æ–‡ä»¶
â”‚           â”‚   â”œâ”€â”€ aicommon.h          # AIé€šç”¨å®šä¹‰
â”‚           â”‚   â””â”€â”€ gj_dll.h            # DLLå¯¼å‡ºå®šä¹‰
â”‚           â”‚
â”‚           â”œâ”€â”€ duix/                   # â­ DUIXæ ¸å¿ƒå®ç°
â”‚           â”‚   â”œâ”€â”€ gjduix.cpp          # ä¸»æ§å®ç°
â”‚           â”‚   â””â”€â”€ gjsimp.cpp          # ç®€åŒ–æ¥å£å®ç°
â”‚           â”‚
â”‚           â”œâ”€â”€ android/                # Android JNIå±‚
â”‚           â”‚   â”œâ”€â”€ DuixJni.cpp         # JNIæ¥å£å®ç°
â”‚           â”‚   â”œâ”€â”€ JniHelper.cpp       # JNIè¾…åŠ©å·¥å…·
â”‚           â”‚   â”œâ”€â”€ JniHelper.h
â”‚           â”‚   â”œâ”€â”€ Log.cpp             # æ—¥å¿—å®ç°
â”‚           â”‚   â””â”€â”€ Log.h
â”‚           â”‚
â”‚           â”œâ”€â”€ dhcore/                 # â­ æ ¸å¿ƒæ•°æ®ç»“æ„åº“
â”‚           â”‚   â”œâ”€â”€ dh_atomic.h         # åŸå­æ“ä½œ
â”‚           â”‚   â”œâ”€â”€ dh_types.h          # ç±»å‹å®šä¹‰
â”‚           â”‚   â”œâ”€â”€ dh_mem.c/h          # å†…å­˜ç®¡ç†
â”‚           â”‚   â”œâ”€â”€ dh_data.cpp/h       # æ•°æ®ç»“æ„
â”‚           â”‚   â”œâ”€â”€ dh_que.cpp/h        # é˜Ÿåˆ—å®ç°
â”‚           â”‚   â””â”€â”€ concurrentqueue.h   # å¹¶å‘é˜Ÿåˆ—ï¼ˆç¬¬ä¸‰æ–¹ï¼‰
â”‚           â”‚
â”‚           â”œâ”€â”€ dhmfcc/                 # â­ éŸ³é¢‘ç‰¹å¾æå–æ¨¡å—
â”‚           â”‚   â”œâ”€â”€ dhpcm.cpp/h         # PCMéŸ³é¢‘å¤„ç†
â”‚           â”‚   â”œâ”€â”€ dhwenet.cpp/h       # WeNeté›†æˆ
â”‚           â”‚   â”œâ”€â”€ wenetai.cpp/h       # WeNet AIæ¥å£
â”‚           â”‚   â”œâ”€â”€ AudioFFT.cpp        # FFTéŸ³é¢‘åˆ†æ
â”‚           â”‚   â”œâ”€â”€ iir_filter.cpp      # IIRæ»¤æ³¢å™¨
â”‚           â”‚   â””â”€â”€ mfcc.cpp            # MFCCç‰¹å¾æå–
â”‚           â”‚
â”‚           â”œâ”€â”€ dhunet/                 # â­ AIæ¨ç†æ¨¡å—
â”‚           â”‚   â”œâ”€â”€ munet.cpp/h         # UNetæ¨¡å‹æ¨ç†
â”‚           â”‚   â”œâ”€â”€ malpha.cpp/h        # Alphaé€šé“å¤„ç†
â”‚           â”‚   â”œâ”€â”€ blendgram.cpp/h     # æ··åˆå›¾å¤„ç†
â”‚           â”‚   â”œâ”€â”€ jmat.cpp/h          # çŸ©é˜µè¿ç®—
â”‚           â”‚   â””â”€â”€ face_utils.cpp/h    # äººè„¸å·¥å…·
â”‚           â”‚
â”‚           â”œâ”€â”€ aes/                    # AESåŠ å¯†æ¨¡å—
â”‚           â”‚   â”œâ”€â”€ aes_core.c          # AESæ ¸å¿ƒç®—æ³•
â”‚           â”‚   â”œâ”€â”€ gj_aes.c/h          # è‡ªå®šä¹‰AESæ¥å£
â”‚           â”‚   â””â”€â”€ base64.c/h          # Base64ç¼–è§£ç 
â”‚           â”‚
â”‚           â””â”€â”€ third/                  # â­ ç¬¬ä¸‰æ–¹åº“
â”‚               â”œâ”€â”€ arm/                # ARMæ¶æ„åº“
â”‚               â”‚   â”œâ”€â”€ arm64-v8a/      # 64ä½ARMåº“
â”‚               â”‚   â”œâ”€â”€ armeabi-v7a/    # 32ä½ARMåº“
â”‚               â”‚   â””â”€â”€ include/        # ç¬¬ä¸‰æ–¹å¤´æ–‡ä»¶
â”‚               â”‚       â”œâ”€â”€ ncnn/       # NCNNç¥ç»ç½‘ç»œåº“
â”‚               â”‚       â”œâ”€â”€ onnx/       # ONNXè¿è¡Œæ—¶
â”‚               â”‚       â”œâ”€â”€ opencv2/    # OpenCVåº“
â”‚               â”‚       â””â”€â”€ tjpeg/      # TurboJPEGåº“
â”‚               â”‚
â”‚               â”œâ”€â”€ ncnn-20231027-android-shared/         # NCNNæ ‡å‡†ç‰ˆ
â”‚               â””â”€â”€ opencv-mobile-4.6.0-android/          # OpenCVç§»åŠ¨ç‰ˆ
â”‚
â””â”€â”€ test/                               # ========== ç¤ºä¾‹åº”ç”¨æ¨¡å— ==========
    â”œâ”€â”€ build.gradle                    # åº”ç”¨æ„å»ºé…ç½®
    â”œâ”€â”€ proguard-rules.pro              # æ··æ·†è§„åˆ™
    â”œâ”€â”€ lint-baseline.xml               # LintåŸºçº¿
    â”œâ”€â”€ .gitignore
    â”‚
    â””â”€â”€ src/main/
        â”œâ”€â”€ AndroidManifest.xml         # åº”ç”¨æ¸…å•
        â”‚
        â”œâ”€â”€ java/ai/guiji/duix/test/
        â”‚   â”œâ”€â”€ App.java                # â­ Applicationå…¥å£
        â”‚   â”‚
        â”‚   â”œâ”€â”€ ui/                     # UIæ¨¡å—
        â”‚   â”‚   â”œâ”€â”€ activity/           # Activityå±‚
        â”‚   â”‚   â”‚   â”œâ”€â”€ BaseActivity.java       # åŸºç¡€Activity
        â”‚   â”‚   â”‚   â”œâ”€â”€ MainActivity.kt         # â­ ä¸»ç•Œé¢(è·¯ç”±)
        â”‚   â”‚   â”‚   â”‚
        â”‚   â”‚   â”‚   â”œâ”€â”€ local/                  # æœ¬åœ°æ•°å­—äººæ¨¡å—ï¼ˆ2025-10-02é‡æ„ï¼‰
        â”‚   â”‚   â”‚   â”‚   â”œâ”€â”€ LocalMainActivity.kt    # æœ¬åœ°æ•°å­—äººé…ç½®ç•Œé¢
        â”‚   â”‚   â”‚   â”‚   â””â”€â”€ LocalCallActivity.kt    # æœ¬åœ°æ•°å­—äººæ’­æ”¾ç•Œé¢
        â”‚   â”‚   â”‚   â”‚
        â”‚   â”‚   â”‚   â””â”€â”€ cloud/                  # äº‘ç«¯æ•°å­—äººæ¨¡å—ï¼ˆ2025-10-02æ–°å¢ï¼‰
        â”‚   â”‚   â”‚       â””â”€â”€ CloudMainActivity.kt    # äº‘ç«¯æ•°å­—äººå ä½ç•Œé¢
        â”‚   â”‚   â”‚
        â”‚   â”‚   â”œâ”€â”€ adapter/            # é€‚é…å™¨
        â”‚   â”‚   â”‚   â”œâ”€â”€ ModelSelectorAdapter.kt # æ¨¡å‹é€‰æ‹©å™¨
        â”‚   â”‚   â”‚   â””â”€â”€ MotionAdapter.kt        # åŠ¨ä½œé€‚é…å™¨
        â”‚   â”‚   â”‚
        â”‚   â”‚   â””â”€â”€ dialog/             # å¯¹è¯æ¡†
        â”‚   â”‚       â”œâ”€â”€ LoadingDialog.kt        # åŠ è½½å¯¹è¯æ¡†
        â”‚   â”‚       â”œâ”€â”€ AudioRecordDialog.kt    # å½•éŸ³å¯¹è¯æ¡†
        â”‚   â”‚       â”œâ”€â”€ ModelSelectorDialog.kt  # æ¨¡å‹é€‰æ‹©å¯¹è¯æ¡†
        â”‚   â”‚       â””â”€â”€ LanguageSelectorDialog.kt # è¯­è¨€é€‰æ‹©å¯¹è¯æ¡†ï¼ˆ2025-10-02æ–°å¢ï¼‰
        â”‚   â”‚
        â”‚   â”œâ”€â”€ audio/                  # éŸ³é¢‘æ¨¡å—
        â”‚   â”‚   â””â”€â”€ AudioRecorder.java  # éŸ³é¢‘å½•åˆ¶å™¨
        â”‚   â”‚
        â”‚   â”œâ”€â”€ net/                    # ç½‘ç»œæ¨¡å—
        â”‚   â”‚   â””â”€â”€ SyncDownloadFile.java # åŒæ­¥ä¸‹è½½
        â”‚   â”‚
        â”‚   â”œâ”€â”€ render/                 # æ¸²æŸ“æ¨¡å—
        â”‚   â”‚   â””â”€â”€ DebugSink.java      # è°ƒè¯•æ¸²æŸ“æ¥æ”¶å™¨
        â”‚   â”‚
        â”‚   â”œâ”€â”€ service/                # æœåŠ¡å±‚
        â”‚   â”‚   â””â”€â”€ StorageService.java # å­˜å‚¨æœåŠ¡
        â”‚   â”‚
        â”‚   â””â”€â”€ util/                   # å·¥å…·ç±»
        â”‚       â”œâ”€â”€ StringUtils.java    # å­—ç¬¦ä¸²å·¥å…·
        â”‚       â”œâ”€â”€ SystemUtils.java    # ç³»ç»Ÿå·¥å…·
        â”‚       â””â”€â”€ ZipUtil.java        # ZIPå·¥å…·
        â”‚
        â””â”€â”€ res/                        # Androidèµ„æº
            â”œâ”€â”€ layout/                 # å¸ƒå±€æ–‡ä»¶
            â”‚   â”œâ”€â”€ activity_cloud_main.xml     # äº‘ç«¯ä¸»ç•Œé¢å¸ƒå±€
            â”‚   â”œâ”€â”€ activity_local_main.xml     # æœ¬åœ°ä¸»ç•Œé¢å¸ƒå±€
            â”‚   â””â”€â”€ activity_local_call.xml     # æœ¬åœ°æ’­æ”¾ç•Œé¢å¸ƒå±€
            â”‚
            â”œâ”€â”€ drawable/               # å›¾å½¢èµ„æº
            â”‚   â”œâ”€â”€ ic_back_to_home.xml         # è¿”å›ä¸»ç•Œé¢å›¾æ ‡
            â”‚   â””â”€â”€ ic_language.xml             # è¯­è¨€å›¾æ ‡ï¼ˆ2025-10-02æ–°å¢ï¼‰
            â”‚
            â”œâ”€â”€ values/                 # å€¼èµ„æºï¼ˆé»˜è®¤ä¸­æ–‡ï¼‰
            â”‚   â”œâ”€â”€ strings.xml
            â”‚   â”œâ”€â”€ colors.xml
            â”‚   â””â”€â”€ themes.xml
            â”‚
            â”œâ”€â”€ values-zh-rCN/          # ç®€ä½“ä¸­æ–‡èµ„æº
            â”‚   â””â”€â”€ strings.xml
            â”‚
            â””â”€â”€ values-en/              # è‹±æ–‡èµ„æºï¼ˆ2025-10-02æ–°å¢ï¼‰
                â””â”€â”€ strings.xml
```

---

## ç¨‹åºå…¥å£ç‚¹

### 1. Applicationå±‚å…¥å£

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/App.java`

```java
public class App extends Application {
    public static App mApp;
    private static OkHttpClient mOkHttpClient;

    @Override
    public void onCreate() {
        super.onCreate();
        mApp = this;
    }

    // æä¾›å…¨å±€OkHttpClientå®ä¾‹
    public static OkHttpClient getOkHttpClient() { ... }
}
```

**åŠŸèƒ½**:
- åº”ç”¨ç¨‹åºå…¨å±€åˆå§‹åŒ–
- æä¾›å…¨å±€OkHttpClientå®ä¾‹ç”¨äºç½‘ç»œè¯·æ±‚

---

### 2. ä¸»ç•Œé¢å…¥å£(è·¯ç”±)

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/ui/activity/MainActivity.kt`

```kotlin
class MainActivity : BaseActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        // 1. æ£€æŸ¥å¹¶æ˜¾ç¤ºæ¬¢è¿é¡µé¢ï¼ˆé¦–æ¬¡å¯åŠ¨ï¼‰
        checkAndShowWelcomePage()

        // 2. æ ¹æ®ç”¨æˆ·é€‰æ‹©è·¯ç”±åˆ°å¯¹åº”ç•Œé¢
        routeBasedOnUserChoice()
    }
}
```

**å¯åŠ¨æµç¨‹**:
```
App.onCreate()
    â†“
MainActivity.onCreate()
    â†“
æ£€æŸ¥æ˜¯å¦é¦–æ¬¡å¯åŠ¨ / æ¬¢è¿é¡µç‰ˆæœ¬æ›´æ–°
    â†“
â”œâ”€[æ˜¯] â†’ æ˜¾ç¤ºWelcomeActivityï¼ˆæ¨¡å¼é€‰æ‹©ï¼‰
â”‚           â†“
â”‚       ç”¨æˆ·é€‰æ‹©æ¨¡å¼ï¼ˆæœ¬åœ°/äº‘ç«¯ï¼‰
â”‚           â†“
â”‚       ä¿å­˜ç”¨æˆ·é€‰æ‹©åˆ°SharedPreferences
â”‚           â†“
â”‚       è¿”å›MainActivity
â”‚           â†“
â””â”€[å¦] â†’ æ ¹æ®ç”¨æˆ·é€‰æ‹©è·¯ç”±
    â†“
â”œâ”€[æœ¬åœ°æ¨¡å¼] â†’ LocalMainActivity (æœ¬åœ°æ•°å­—äººé…ç½®)
â”‚                     â†“
â”‚                LocalCallActivity (æœ¬åœ°æ•°å­—äººæ’­æ”¾)
â”‚
â””â”€[äº‘ç«¯æ¨¡å¼] â†’ CloudMainActivity (äº‘ç«¯æ•°å­—äººå ä½)
```

---

### 3. æ¬¢è¿é¡µå…¥å£

**æ–‡ä»¶**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/welcome/WelcomeActivity.kt`

```kotlin
class WelcomeActivity : AppCompatActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        // åˆå§‹åŒ–WebView
        setupWebView()

        // åŠ è½½æ¬¢è¿é¡µHTML
        webView.loadUrl("file:///android_asset/welcome/welcome.html")

        // è®¾ç½®JavaScriptæ¡¥æ¥
        setupJavaScriptBridge()
    }

    @JavascriptInterface
    fun onLocalChoice() {
        // ä¿å­˜æœ¬åœ°æ¨¡å¼é€‰æ‹©
        WelcomeConfig.saveUserChoice(this, UserChoice.LOCAL)
        finish()
    }

    @JavascriptInterface
    fun onCloudChoice() {
        // ä¿å­˜äº‘ç«¯æ¨¡å¼é€‰æ‹©
        WelcomeConfig.saveUserChoice(this, UserChoice.CLOUD)
        finish()
    }
}
```

**æ¬¢è¿é¡µæŠ€æœ¯æ ˆ**:
- **UI**: WebView + HTML/CSS/JavaScript
- **æ ·å¼**: Tailwind CSS + è‡ªå®šä¹‰CSS
- **å›½é™…åŒ–**: i18n.js (2025-10-02æ–°å¢)
- **äº¤äº’**: AndroidBridge (JavaScript â†” Androidé€šä¿¡)

---

### 4. æœ¬åœ°æ•°å­—äººé…ç½®å…¥å£

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/ui/activity/local/LocalMainActivity.kt`

```kotlin
class LocalMainActivity : BaseActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityLocalMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        setupDefaultValues()  // åˆå§‹åŒ–é»˜è®¤é…ç½®
        setupUI()             // è®¾ç½®UIç»„ä»¶
        setupListeners()      // è®¾ç½®ç›‘å¬å™¨
    }

    private fun setupDefaultValues() {
        // é»˜è®¤æ¨¡å‹URL
        binding.etModelUrl.setText(DEFAULT_MODEL_URL)
        // é»˜è®¤BaseConfigURLï¼ˆè‡ªåŠ¨è®¾ç½®ï¼‰
        binding.etBaseConfigUrl.setText(DEFAULT_BASE_CONFIG_URL)
    }
}
```

**æ ¸å¿ƒåŠŸèƒ½**:
1. **æ¨¡å‹é€‰æ‹©** - é€šè¿‡ModelSelectorDialogé€‰æ‹©æ¨¡å‹
2. **æ¨¡å‹ä¸‹è½½** - è‡ªåŠ¨æ£€æŸ¥å’Œä¸‹è½½æ¨¡å‹
3. **é«˜çº§è®¾ç½®** - å¯æŠ˜å çš„è°ƒè¯•é€‰é¡¹é¢æ¿
4. **å¯åŠ¨æ’­æ”¾** - å¯åŠ¨LocalCallActivityè¿›è¡Œæ•°å­—äººæ¸²æŸ“

**UIè®¾è®¡ç‰¹æ€§** (2025-10-02é‡æ„):
- âœ… **æ¨¡å—åŒ–è®¾è®¡**: UIä¸ä¸šåŠ¡é€»è¾‘åˆ†ç¦»
- âœ… **ç°ä»£åŒ–ç•Œé¢**: æ¸å˜æŒ‰é’®ã€åœ†è§’è¾“å…¥æ¡†ã€å¡ç‰‡å¼è®¾è®¡
- âœ… **äº¤äº’ä¼˜åŒ–**: å¯¹è¯æ¡†ä»£æ›¿ä¸‹æ‹‰æ¡†ã€å¯æŠ˜å é«˜çº§è®¾ç½®
- âœ… **ç®€åŒ–é…ç½®**: BaseConfigURLè‡ªåŠ¨è®¾ç½®

---

### 5. æœ¬åœ°æ•°å­—äººæ’­æ”¾å…¥å£

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/ui/activity/local/LocalCallActivity.kt`

```kotlin
class LocalCallActivity : BaseActivity() {
    private var duix: DUIX? = null
    private var mDUIXRender: DUIXRenderer? = null

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        // 1. åˆå§‹åŒ–OpenGLæ¸²æŸ“è§†å›¾
        setupGLView()

        // 2. åˆ›å»ºDUIXå®ä¾‹
        duix = DUIX(context, modelUrl, renderer, callback)

        // 3. åˆå§‹åŒ–æ•°å­—äºº
        duix.init()
    }
}
```

**æ•°å­—äººåˆå§‹åŒ–æµç¨‹**:
```
LocalCallActivity.onCreate()
    â†“
åˆ›å»ºDUIXRendererï¼ˆOpenGLæ¸²æŸ“å™¨ï¼‰
    â†“
åˆ›å»ºDUIXå®ä¾‹
    â†“
DUIX.init()
    â†“
DUIXInitializer.checkModelFiles()
    â”œâ”€ gj_dh_res (åŸºç¡€é…ç½®)
    â””â”€ å…·ä½“æ¨¡å‹æ–‡ä»¶
    â†“
åˆ›å»ºRenderThreadï¼ˆæ¸²æŸ“çº¿ç¨‹ï¼‰
    â†“
RenderThread.start()
    â†“
Nativeå±‚åˆå§‹åŒ– (gjduix.cpp)
    â†“
åŠ è½½AIæ¨¡å‹
    â”œâ”€ NCNNæ¨¡å‹
    â”œâ”€ ONNXæ¨¡å‹
    â””â”€ æ¨¡å‹é…ç½®
    â†“
å›è°ƒ: CALLBACK_EVENT_INIT_READY
    â†“
æ•°å­—äººå°±ç»ªï¼Œå¯ä»¥æ’­æ”¾éŸ³é¢‘å’ŒåŠ¨ä½œ
```

---

### 6. äº‘ç«¯æ•°å­—äººå…¥å£

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/ui/activity/cloud/CloudMainActivity.kt`

```kotlin
class CloudMainActivity : BaseActivity() {
    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)
        binding = ActivityCloudMainBinding.inflate(layoutInflater)
        setContentView(binding.root)

        // æ˜¾ç¤ºå ä½ç•Œé¢
        // æç¤ºï¼šäº‘ç«¯æ•°å­—äººåŠŸèƒ½å°šæœªå¼€å‘
    }
}
```

**çŠ¶æ€**: å ä½ç•Œé¢ï¼Œäº‘ç«¯åŠŸèƒ½å¾…å¼€å‘

---

### 7. SDKæ ¸å¿ƒå…¥å£

**æ–‡ä»¶**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/client/DUIX.java`

```java
public class DUIX {
    private final Context mContext;
    private final Callback mCallback;
    private final String modelName;
    private final RenderSink renderSink;

    private RenderThread mRenderThread;
    private DUIXInitializer initializer;
    private DUIXAudioController audioController;
    private DUIXMotionController motionController;

    // ä¸»åˆå§‹åŒ–æ–¹æ³•
    public void init() {
        // 1. æ£€æŸ¥æ¨¡å‹æ–‡ä»¶
        initializer.checkModelFiles();

        // 2. åˆ›å»ºæ¸²æŸ“çº¿ç¨‹
        mRenderThread = new RenderThread(...);
        mRenderThread.start();

        // 3. åˆå§‹åŒ–æ§åˆ¶å™¨
        audioController = new DUIXAudioController(mRenderThread);
        motionController = new DUIXMotionController(mRenderThread);
    }

    // PCMéŸ³é¢‘é©±åŠ¨
    public void startPush() { audioController.startPush(); }
    public void pushPcm(byte[] buffer) { audioController.pushPcm(buffer); }
    public void stopPush() { audioController.stopPush(); }

    // WAVæ–‡ä»¶æ’­æ”¾
    public void playAudio(String wavPath) { audioController.playAudio(wavPath); }
    public void stopAudio() { audioController.stopAudio(); }

    // åŠ¨ä½œæ§åˆ¶
    public void startMotion(String name, boolean now) {
        motionController.startMotion(name, now);
    }
    public void startRandomMotion(boolean now) {
        motionController.startRandomMotion(now);
    }

    // éŸ³é‡æ§åˆ¶
    public void setVolume(float volume) {
        audioController.setVolume(volume);
    }

    // èµ„æºé‡Šæ”¾
    public void release() {
        if (mRenderThread != null) {
            mRenderThread.stopPreview();
        }
    }
}
```

**æ ¸å¿ƒAPIè°ƒç”¨é“¾**:
```
DUIX.init()
    â†“
RenderThread.start()
    â†“
Native: gjduix_init() [JNI]
    â†“
åŠ è½½æ¨¡å‹å’Œèµ„æº
    â†“
å¯åŠ¨æ¸²æŸ“å¾ªç¯

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

éŸ³é¢‘æ’­æ”¾æµç¨‹:
DUIX.playAudio()
    â†“
DUIX.startPush()
    â†“
DUIX.pushPcm() [å¾ªç¯]
    â†“
RenderThread.pushAudio()
    â†“
Native: éŸ³é¢‘ç‰¹å¾æå– (dhmfcc)
    â†“
Native: AIæ¨ç†ç”Ÿæˆå›¾åƒ (dhunet)
    â†“
OpenGLæ¸²æŸ“å›¾åƒ
    â†“
DUIX.stopPush()
```

---

### 8. Nativeå±‚å…¥å£

**æ–‡ä»¶**: `duix-sdk/src/main/cpp/android/DuixJni.cpp`

```cpp
// JNIå…¥å£ç‚¹
JNIEXPORT jint JNICALL
Java_ai_guiji_duix_DuixNcnn_duixInit(
    JNIEnv* env, jclass clazz,
    jstring modelPath, jlong callback) {

    // è°ƒç”¨gjduixæ ¸å¿ƒ
    return gjduix_init(...);
}

JNIEXPORT jint JNICALL
Java_ai_guiji_duix_DuixNcnn_duixPushAudio(
    JNIEnv* env, jclass clazz,
    jbyteArray pcmData) {

    // æ¨é€éŸ³é¢‘æ•°æ®
    return gjduix_push_audio(...);
}
```

**Nativeè°ƒç”¨é“¾**:
```
JNIå±‚ (DuixJni.cpp)
    â†“
DUIXæ ¸å¿ƒ (gjduix.cpp)
    â”œâ”€ æ¨¡å‹åŠ è½½
    â”œâ”€ éŸ³é¢‘å¤„ç†
    â””â”€ å›¾åƒç”Ÿæˆ
    â†“
å­æ¨¡å—è°ƒç”¨:
â”œâ”€ dhcore   (å†…å­˜ç®¡ç†ã€é˜Ÿåˆ—)
â”œâ”€ dhmfcc   (éŸ³é¢‘ç‰¹å¾æå–)
â””â”€ dhunet   (AIæ¨¡å‹æ¨ç†)
    â†“
ç¬¬ä¸‰æ–¹åº“:
â”œâ”€ NCNN     (ç¥ç»ç½‘ç»œæ¨ç†)
â”œâ”€ ONNX     (æ¨¡å‹è¿è¡Œæ—¶)
â”œâ”€ OpenCV   (å›¾åƒå¤„ç†)
â””â”€ TurboJPEG (JPEGç¼–è§£ç )
```

---

## ä¾èµ–å…³ç³»åˆ†æ

### æ¨¡å—ä¾èµ–å…³ç³»å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  test (åº”ç”¨æ¨¡å—)                       â”‚
â”‚                                                        â”‚
â”‚  ä¾èµ–:                                                 â”‚
â”‚  â”œâ”€ project(":duix-sdk")        [æ¨¡å—ä¾èµ–]            â”‚
â”‚  â”œâ”€ androidx.core:core-ktx:1.12.0                    â”‚
â”‚  â”œâ”€ androidx.appcompat:appcompat:1.2.0               â”‚
â”‚  â”œâ”€ com.google.android.material:material:1.4.0       â”‚
â”‚  â”œâ”€ androidx.constraintlayout:constraintlayout:2.1.1 â”‚
â”‚  â”œâ”€ com.github.bumptech.glide:glide:4.12.0  [å›¾ç‰‡]   â”‚
â”‚  â””â”€ com.squareup.okhttp3:okhttp:4.10.0      [ç½‘ç»œ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                duix-sdk (SDKæ¨¡å—)                      â”‚
â”‚                                                        â”‚
â”‚  Java/Kotlinä¾èµ–:                                     â”‚
â”‚  â”œâ”€ androidx.appcompat:appcompat:1.6.1               â”‚
â”‚  â”œâ”€ androidx.activity:activity-ktx:1.7.2             â”‚
â”‚  â””â”€ fileTree(dir: 'libs', include: ['*.jar', '*.aar'])â”‚
â”‚                                                        â”‚
â”‚  Nativeä¾èµ– (CMake):                                  â”‚
â”‚  â”œâ”€ dhcore (é™æ€åº“)                                   â”‚
â”‚  â”œâ”€ dhmfcc (é™æ€åº“)                                   â”‚
â”‚  â”œâ”€ dhunet (é™æ€åº“)                                   â”‚
â”‚  â”œâ”€ gjduix (åŠ¨æ€åº“)                                   â”‚
â”‚  â”‚                                                     â”‚
â”‚  â””â”€ ç¬¬ä¸‰æ–¹åº“:                                         â”‚
â”‚      â”œâ”€ OpenCV mobile 4.6.0                          â”‚
â”‚      â”œâ”€ NCNN 20231027                                â”‚
â”‚      â”œâ”€ ONNX Runtime                                 â”‚
â”‚      â”œâ”€ TurboJPEG                                    â”‚
â”‚      â””â”€ libjpeg                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Javaå±‚ä¾èµ–é“¾

#### testæ¨¡å—ä¸»è¦ç±»ä¾èµ–

```
App.java
â””â”€ æ— å¤–éƒ¨ä¾èµ–ï¼Œçº¯Applicationç±»

MainActivity.kt
â”œâ”€ duix-sdkä¾èµ–:
â”‚   â”œâ”€ VirtualModelUtil (æ¨¡å‹ç®¡ç†)
â”‚   â”œâ”€ WelcomeActivity (æ¬¢è¿é¡µ)
â”‚   â”œâ”€ WelcomeConfig (é…ç½®ç®¡ç†)
â”‚   â””â”€ LanguageManager (è¯­è¨€ç®¡ç†)  â† 2025-10-02æ–°å¢
â”œâ”€ UIç»„ä»¶:
â”‚   â”œâ”€ LoadingDialog
â”‚   â”œâ”€ ModelSelectorDialog
â”‚   â””â”€ LanguageSelectorDialog  â† 2025-10-02æ–°å¢
â””â”€ Androidç³»ç»Ÿåº“

LocalCallActivity.kt
â”œâ”€ duix-sdkæ ¸å¿ƒ:
â”‚   â”œâ”€ DUIX (ä¸»æ§ç±») â­
â”‚   â”œâ”€ DUIXRenderer (æ¸²æŸ“å™¨)
â”‚   â”œâ”€ RenderThread (æ¸²æŸ“çº¿ç¨‹)
â”‚   â””â”€ Constant (å¸¸é‡)
â”œâ”€ UIç»„ä»¶:
â”‚   â”œâ”€ MotionAdapter
â”‚   â””â”€ AudioRecordDialog
â”œâ”€ ç¬¬ä¸‰æ–¹åº“:
â”‚   â””â”€ Glide (å›¾ç‰‡åŠ è½½)
â””â”€ Androidç³»ç»Ÿåº“
```

#### duix-sdkæ ¸å¿ƒç±»ä¾èµ–

```
DUIX.java (â­ SDKå…¥å£ - 2025-10-02é‡æ„)
â”œâ”€ DUIXInitializer (åˆå§‹åŒ–å™¨)
â”œâ”€ DUIXAudioController (éŸ³é¢‘æ§åˆ¶å™¨)
â”œâ”€ DUIXMotionController (åŠ¨ä½œæ§åˆ¶å™¨)
â”œâ”€ RenderThread (æ¸²æŸ“çº¿ç¨‹)
â”œâ”€ RenderSink (æ¸²æŸ“æ¥å£)
â”œâ”€ Callback (å›è°ƒæ¥å£)
â””â”€ Constant (å¸¸é‡)
    â†“
RenderThread.java (â­ æ ¸å¿ƒæ¸²æŸ“çº¿ç¨‹)
â”œâ”€ DuixNcnn (JNIæ¥å£)
â”œâ”€ AudioPlayer (éŸ³é¢‘æ’­æ”¾)
â”œâ”€ ImageFrame (å›¾åƒå¸§)
â”œâ”€ AudioFrame (éŸ³é¢‘å¸§)
â”œâ”€ RenderSink (æ¸²æŸ“æ¥æ”¶å™¨)
â””â”€ å„ç§Utilå·¥å…·ç±»
    â†“
DUIXRenderer.java (OpenGLæ¸²æŸ“å™¨)
â”œâ”€ ImageDrawer (å›¾åƒç»˜åˆ¶)
â”œâ”€ TextureMatrix (çº¹ç†çŸ©é˜µ)
â”œâ”€ OpenGLUtil (OpenGLå·¥å…·)
â””â”€ DUIXTextureView (çº¹ç†è§†å›¾)
    â†“
DuixNcnn.java (JNIå£°æ˜)
â””â”€ Nativeæ–¹æ³•å£°æ˜
    â†“
[JNIè¾¹ç•Œ]
    â†“
DuixJni.cpp (Nativeå®ç°)
```

### Nativeå±‚ä¾èµ–é“¾

```
gjduix.so (ä¸»åŠ¨æ€åº“)
â”œâ”€ ä¾èµ–é™æ€åº“:
â”‚   â”œâ”€ dhcore.a
â”‚   â”œâ”€ dhmfcc.a
â”‚   â””â”€ dhunet.a
â”‚
â”œâ”€ ä¾èµ–ç¬¬ä¸‰æ–¹åº“:
â”‚   â”œâ”€ libopencv_core.so
â”‚   â”œâ”€ libopencv_imgproc.so
â”‚   â”œâ”€ libncnn.so
â”‚   â”œâ”€ libonnxruntime.so
â”‚   â”œâ”€ libturbojpeg.a
â”‚   â””â”€ libjpeg.a
â”‚
â””â”€ ç³»ç»Ÿåº“:
    â”œâ”€ liblog.so (æ—¥å¿—)
    â”œâ”€ libz.so (å‹ç¼©)
    â”œâ”€ libm.so (æ•°å­¦)
    â”œâ”€ libpthread (çº¿ç¨‹)
    â””â”€ libandroid.so (Android API)
```

### ç¬¬ä¸‰æ–¹åº“è¯¦ç»†è¯´æ˜

| åº“å | ç‰ˆæœ¬ | ç”¨é€” | ä¾èµ–æ–¹å¼ |
|------|------|------|---------|
| **NCNN** | 20231027 | ç¥ç»ç½‘ç»œæ¨ç†å¼•æ“ï¼Œç”¨äºAIæ¨¡å‹æ¨ç† | åŠ¨æ€é“¾æ¥ (.so) |
| **OpenCV Mobile** | 4.6.0 | å›¾åƒå¤„ç†åº“ï¼Œç”¨äºå›¾åƒå˜æ¢ã€è‰²å½©è½¬æ¢ç­‰ | åŠ¨æ€é“¾æ¥ (.so) |
| **ONNX Runtime** | - | ONNXæ¨¡å‹è¿è¡Œæ—¶ï¼Œæ”¯æŒONNXæ ¼å¼æ¨¡å‹ | åŠ¨æ€é“¾æ¥ (.so) |
| **TurboJPEG** | - | é«˜æ€§èƒ½JPEGç¼–è§£ç åº“ | é™æ€é“¾æ¥ (.a) |
| **libjpeg** | - | JPEGæ ‡å‡†åº“ | é™æ€é“¾æ¥ (.a) |
| **Glide** | 4.12.0 | å›¾ç‰‡åŠ è½½åº“ï¼ˆtestæ¨¡å—ï¼‰ | Gradleä¾èµ– |
| **OkHttp** | 4.10.0 | HTTPå®¢æˆ·ç«¯ï¼ˆtestæ¨¡å—ï¼‰ | Gradleä¾èµ– |
| **AndroidX** | å¤šç‰ˆæœ¬ | Androidæ”¯æŒåº“ | Gradleä¾èµ– |

---

## æ ¸å¿ƒæ¨¡å—è¯´æ˜

### 1. DUIXæ ¸å¿ƒæ¨¡å—ï¼ˆ2025-10-02é‡æ„ï¼‰

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/client/DUIX.java`

**èŒè´£**: SDKä¸»æ§ç±»ï¼Œç»Ÿä¸€å¯¹å¤–APIæ¥å£ï¼Œé‡‡ç”¨æ§åˆ¶å™¨æ¨¡å¼è§£è€¦

**æ¶æ„è®¾è®¡**:
```
DUIX (ä¸»æ§ç±»)
â”œâ”€ DUIXInitializer      (åˆå§‹åŒ–æ§åˆ¶å™¨)
â”œâ”€ DUIXAudioController  (éŸ³é¢‘æ§åˆ¶å™¨)
â””â”€ DUIXMotionController (åŠ¨ä½œæ§åˆ¶å™¨)
```

**æ ¸å¿ƒåŠŸèƒ½**:

```java
// 1. åˆå§‹åŒ–æ•°å­—äºº
public void init()
// æ£€æŸ¥æ¨¡å‹æ–‡ä»¶ â†’ åˆ›å»ºæ¸²æŸ“çº¿ç¨‹ â†’ Nativeåˆå§‹åŒ–

// 2. PCMæµå¼éŸ³é¢‘é©±åŠ¨
public void startPush()      // å¼€å§‹æ¨é€
public void pushPcm(byte[])  // æ¨é€PCMæ•°æ®
public void stopPush()       // åœæ­¢æ¨é€

// 3. WAVæ–‡ä»¶æ’­æ”¾
public void playAudio(String wavPath)
// è¯»å–WAVæ–‡ä»¶ â†’ è·³è¿‡44å­—èŠ‚å¤´ â†’ è½¬ä¸ºPCMæ¨é€

// 4. åœæ­¢éŸ³é¢‘
public boolean stopAudio()

// 5. åŠ¨ä½œæ§åˆ¶
public void startMotion(String name, boolean now)     // æŒ‡å®šåŠ¨ä½œ
public void startRandomMotion(boolean now)            // éšæœºåŠ¨ä½œ

// 6. éŸ³é‡æ§åˆ¶
public void setVolume(float volume)  // 0.0 ~ 1.0

// 7. èµ„æºé‡Šæ”¾
public void release()
```

**å›è°ƒäº‹ä»¶**:
```java
CALLBACK_EVENT_INIT_READY        // åˆå§‹åŒ–å®Œæˆ
CALLBACK_EVENT_INIT_ERROR        // åˆå§‹åŒ–å¤±è´¥
CALLBACK_EVENT_AUDIO_PLAY_START  // éŸ³é¢‘æ’­æ”¾å¼€å§‹
CALLBACK_EVENT_AUDIO_PLAY_END    // éŸ³é¢‘æ’­æ”¾ç»“æŸ
CALLBACK_EVENT_AUDIO_PLAY_ERROR  // éŸ³é¢‘æ’­æ”¾é”™è¯¯
CALLBACK_EVENT_MOTION_START      // åŠ¨ä½œæ’­æ”¾å¼€å§‹
CALLBACK_EVENT_MOTION_END        // åŠ¨ä½œæ’­æ”¾ç»“æŸ
```

**é‡æ„äº®ç‚¹** (2025-10-02):
- âœ… **å•ä¸€èŒè´£**: æ¯ä¸ªæ§åˆ¶å™¨åªè´Ÿè´£ä¸€ä¸ªåŠŸèƒ½æ¨¡å—
- âœ… **ä¾èµ–å€’ç½®**: é€šè¿‡æ¥å£éš”ç¦»ï¼Œé™ä½è€¦åˆ
- âœ… **æ˜“äºæµ‹è¯•**: æ¯ä¸ªæ§åˆ¶å™¨å¯ç‹¬ç«‹æµ‹è¯•
- âœ… **å¯ç»´æŠ¤æ€§**: ä»£ç ç»“æ„æ¸…æ™°ï¼Œæ˜“äºæ‰©å±•

---

### 2. RenderThreadæ¸²æŸ“çº¿ç¨‹

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/client/thread/RenderThread.java`

**èŒè´£**: æ ¸å¿ƒæ¸²æŸ“çº¿ç¨‹ï¼Œç®¡ç†Nativeå±‚äº¤äº’å’ŒOpenGLæ¸²æŸ“

**æ ¸å¿ƒåŠŸèƒ½**:
- éŸ³é¢‘é˜Ÿåˆ—ç®¡ç†
- Nativeå±‚åˆå§‹åŒ–å’Œè°ƒç”¨
- å¸§æ¸²æŸ“æ§åˆ¶
- éŸ³é¢‘æ’­æ”¾æ§åˆ¶
- çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸç®¡ç†

**å…³é”®æ–¹æ³•**:
```java
// Nativeæ¥å£è°ƒç”¨
private native int duixInit(...)          // åˆå§‹åŒ–
private native int duixPushAudio(...)     // æ¨é€éŸ³é¢‘
private native int duixRender(...)        // æ¸²æŸ“å¸§
private native void duixRelease()         // é‡Šæ”¾èµ„æº

// éŸ³é¢‘æ§åˆ¶
public void startPush()                   // å¼€å§‹æ¥æ”¶éŸ³é¢‘
public void pushAudio(byte[] pcm)         // æ¨é€éŸ³é¢‘åˆ°é˜Ÿåˆ—
public void stopPush()                    // åœæ­¢æ¥æ”¶éŸ³é¢‘
public void stopPlayAudio()               // åœæ­¢æ’­æ”¾

// åŠ¨ä½œæ§åˆ¶
public void startMotion(...)              // å¼€å§‹åŠ¨ä½œ
public void startRandomMotion()           // éšæœºåŠ¨ä½œ

// çº¿ç¨‹æ§åˆ¶
public void run()                         // æ¸²æŸ“å¾ªç¯
public void stopPreview()                 // åœæ­¢æ¸²æŸ“
```

**çº¿ç¨‹æ¨¡å‹**:
```
RenderThread [ç‹¬ç«‹çº¿ç¨‹]
â”œâ”€ éŸ³é¢‘é˜Ÿåˆ— (ConcurrentLinkedQueue)
â”‚   â”œâ”€ pushAudio() â†’ å…¥é˜Ÿ
â”‚   â””â”€ æ¸²æŸ“å¾ªç¯ â†’ å‡ºé˜Ÿ
â”‚
â”œâ”€ æ¸²æŸ“å¾ªç¯ (while running)
â”‚   â”œâ”€ å–å‡ºéŸ³é¢‘æ•°æ®
â”‚   â”œâ”€ Nativeæ¨é€ (duixPushAudio)
â”‚   â”œâ”€ Nativeæ¸²æŸ“ (duixRender)
â”‚   â”œâ”€ è·å–å›¾åƒå¸§
â”‚   â”œâ”€ è°ƒç”¨RenderSink.onFrame()
â”‚   â””â”€ ç­‰å¾…ä¸‹ä¸€å¸§
â”‚
â””â”€ çŠ¶æ€ç®¡ç†
    â”œâ”€ isPushing (æ˜¯å¦æ­£åœ¨æ¥æ”¶éŸ³é¢‘)
    â”œâ”€ isPlaying (æ˜¯å¦æ­£åœ¨æ’­æ”¾)
    â””â”€ stopFlag (åœæ­¢æ ‡å¿—)
```

---

### 3. DUIXRendereræ¸²æŸ“å™¨

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/client/render/DUIXRenderer.java`

**èŒè´£**: OpenGL ESæ¸²æŸ“å™¨ï¼Œè´Ÿè´£å°†å›¾åƒå¸§æ¸²æŸ“åˆ°å±å¹•

**æ ¸å¿ƒåŠŸèƒ½**:
```java
// GLSurfaceView.Rendereræ¥å£å®ç°
public void onSurfaceCreated(GL10, EGLConfig)   // Surfaceåˆ›å»º
public void onSurfaceChanged(GL10, int, int)    // Surfaceå°ºå¯¸å˜åŒ–
public void onDrawFrame(GL10)                   // ç»˜åˆ¶å¸§

// RenderSinkæ¥å£å®ç°
public void onFrame(ImageFrame frame)           // æ¥æ”¶æ–°å¸§
public void requestRender()                     // è¯·æ±‚æ¸²æŸ“
```

**æ¸²æŸ“æµç¨‹**:
```
ImageFrame (Nativeç”Ÿæˆ)
    â†“
RenderThread.onFrame()
    â†“
DUIXRenderer.onFrame()
    â”œâ”€ ä¿å­˜ImageFrame
    â””â”€ è¯·æ±‚GLSurfaceViewæ¸²æŸ“
    â†“
onDrawFrame() [GLçº¿ç¨‹]
    â”œâ”€ å–å‡ºImageFrame
    â”œâ”€ ä¸Šä¼ çº¹ç†åˆ°GPU
    â”œâ”€ ImageDrawer.draw()
    â””â”€ SwapBuffersæ˜¾ç¤º
```

**æ”¯æŒç‰¹æ€§**:
- RGBAæ ¼å¼æ”¯æŒï¼ˆé€æ˜é€šé“ï¼‰
- åŒç¼“å†²æ¸²æŸ“
- è‡ªé€‚åº”å°ºå¯¸
- èƒŒæ™¯é€æ˜æ¸²æŸ“

---

### 4. VirtualModelUtilæ¨¡å‹å·¥å…·

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/client/VirtualModelUtil.java`

**èŒè´£**: æ•°å­—äººæ¨¡å‹ä¸‹è½½å’Œç®¡ç†

**æ ¸å¿ƒåŠŸèƒ½**:
```java
// æ¨¡å‹æ£€æŸ¥
public static boolean checkBaseConfig(Context)
public static boolean checkModel(Context, String url)

// æ¨¡å‹ä¸‹è½½
public static void baseConfigDownload(Context, String url, Callback)
public static void modelDownload(Context, String url, Callback)

// å›è°ƒæ¥å£
interface ModelDownloadCallback {
    void onDownloadProgress(String url, long current, long total)
    void onUnzipProgress(String url, long current, long total)
    void onDownloadComplete(String url, File dir)
    void onDownloadFail(String url, int code, String msg)
}
```

**æ¨¡å‹ç›®å½•ç»“æ„**:
```
/sdcard/Android/data/<package>/files/duix/
â”œâ”€â”€ model/
â”‚   â”œâ”€â”€ gj_dh_res/              # åŸºç¡€é…ç½®ï¼ˆå¿…éœ€ï¼‰
â”‚   â”‚   â”œâ”€â”€ *.param             # NCNNæ¨¡å‹å‚æ•°
â”‚   â”‚   â”œâ”€â”€ *.bin               # NCNNæ¨¡å‹æƒé‡
â”‚   â”‚   â””â”€â”€ *.onnx              # ONNXæ¨¡å‹
â”‚   â”‚
â”‚   â”œâ”€â”€ <model_name>/           # å…·ä½“æ•°å­—äººæ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ model.json          # æ¨¡å‹é…ç½®
â”‚   â”‚   â”œâ”€â”€ texture/            # çº¹ç†èµ„æº
â”‚   â”‚   â”œâ”€â”€ motion/             # åŠ¨ä½œæ•°æ®
â”‚   â”‚   â””â”€â”€ audio/              # éŸ³é¢‘èµ„æº
â”‚   â”‚
â”‚   â””â”€â”€ tmp/                    # ä¸‹è½½æ ‡è®°
â”‚       â”œâ”€â”€ gj_dh_res
â”‚       â””â”€â”€ <model_name>
```

---

### 5. Welcomeæ¬¢è¿é¡µæ¨¡å—

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/welcome/`

**æ–‡ä»¶ç»„æˆ**:
- `WelcomeActivity.kt`: æ¬¢è¿é¡µActivity
- `WelcomeConfig.kt`: é…ç½®ç®¡ç†
- `WelcomeIntegrationExample.kt`: é›†æˆç¤ºä¾‹
- `assets/welcome/welcome.html`: æ¬¢è¿é¡µUIç•Œé¢ï¼ˆ2025-10-02ç¾åŒ–å‡çº§ï¼‰
- `assets/welcome/js/i18n.js`: å›½é™…åŒ–è„šæœ¬ï¼ˆ2025-10-02æ–°å¢ï¼‰

**è®¾è®¡æ¶æ„**: WebView + HTML/CSS/JS + Tailwind CSS

**åŠŸèƒ½ç‰¹æ€§**:
- æœ¬åœ°/äº‘ç«¯æ¨¡å¼é€‰æ‹©
- é¦–æ¬¡å¯åŠ¨å¼•å¯¼
- ç”¨æˆ·é€‰æ‹©æŒä¹…åŒ–
- ç‰ˆæœ¬ç®¡ç†
- ç°ä»£åŒ–UIè®¾è®¡ä¸æµç•…åŠ¨ç”»æ•ˆæœ
- å®Œæ•´çš„å›½é™…åŒ–æ”¯æŒï¼ˆä¸­è‹±æ–‡ï¼‰

**UIè®¾è®¡ç‰¹æ€§** (2025-10-02å‡çº§):
- âœ… **æ¸å˜èƒŒæ™¯**: åŠ¨æ€æ¸å˜èƒŒæ™¯ï¼Œ15ç§’å¾ªç¯åŠ¨ç”»ï¼Œè¥é€ ç§‘æŠ€æ„Ÿæ°›å›´
- âœ… **æ¯›ç»ç’ƒæ•ˆæœ**: å¡ç‰‡é‡‡ç”¨backdrop-filterå®ç°èƒŒæ™¯æ¨¡ç³Šæ•ˆæœ
- âœ… **æµç•…åŠ¨ç”»**: é¡µé¢åŠ è½½åŠ¨ç”»(fadeIn/fadeInDown/fadeInUp)ã€æ‚¬æµ®æ•ˆæœã€ç‚¹å‡»åé¦ˆ
- âœ… **æ°´æ³¢çº¹æ‰©æ•£**: Logoå…‰ç¯æŒç»­å‘å¤–æ‰©æ•£æ•ˆæœï¼Œä¸‰å±‚å…‰ç¯äº¤é”™æ‰©æ•£(2.5ç§’å‘¨æœŸï¼Œå»¶è¿Ÿ0.8s)
- âœ… **çº¯å‡€Logo**: 120pxåœ†å½¢Logoï¼Œæ— è¾¹æ¡†æ— èƒŒæ™¯ï¼Œä»…ä¿ç•™å›¾ç‰‡é˜´å½±
- âœ… **å¤§å‹è£…é¥°åœ†åœˆ**: 3ä¸ªå½©è‰²æ¸å˜å¤§åœ†(350-450px)ï¼Œå¾„å‘æ¸å˜+60pxæ¨¡ç³Šï¼Œå…¨å±éšæœºç§»åŠ¨
- âœ… **äº¤äº’åé¦ˆ**: æ‚¬æµ®æ—¶å¡ç‰‡ä¸Šç§»5pxå¹¶ç¼©æ”¾1.02å€ï¼Œç‚¹å‡»æ—¶ç¼©æ”¾0.98å€
- âœ… **å“åº”å¼è®¾è®¡**: æ”¯æŒå°å±(â‰¤640px)ã€ä¸­å±(641-1024px)ã€å¤§å±è‡ªé€‚åº”
- âœ… **é«˜æ€§èƒ½**: ä½¿ç”¨GPUåŠ é€Ÿçš„CSSå±æ€§(transform/opacity)ï¼Œé¿å…è§¦å‘é‡æ’
- âœ… **å›½é™…åŒ–**: æ”¯æŒä¸­è‹±æ–‡åŒè¯­åˆ‡æ¢ï¼ˆ2025-10-02æ–°å¢ï¼‰

**é¢œè‰²æ–¹æ¡ˆ**:
- ä¸»èƒŒæ™¯æ¸å˜: `#667eea` â†’ `#764ba2` â†’ `#f093fb`
- æœ¬åœ°æ¨¡å¼å›¾æ ‡: `#667eea` â†’ `#764ba2` (ç´«è‰²æ¸å˜)
- äº‘ç«¯æ¨¡å¼å›¾æ ‡: `#f093fb` â†’ `#f5576c` (ç²‰è‰²æ¸å˜)
- å¡ç‰‡èƒŒæ™¯: `rgba(255,255,255,0.95)` (åŠé€æ˜ç™½è‰²)

**WebViewäº¤äº’**:
```javascript
// HTML/JSè°ƒç”¨Android
window.AndroidBridge.onLocalChoice()  // é€‰æ‹©æœ¬åœ°æ¨¡å¼
window.AndroidBridge.onCloudChoice()  // é€‰æ‹©äº‘ç«¯æ¨¡å¼
window.AndroidBridge.onPageLoaded()   // é¡µé¢åŠ è½½å®Œæˆ

// Androidå“åº”
@JavascriptInterface
fun onLocalChoice() {
    // ä¿å­˜é€‰æ‹© â†’ è®¾ç½®ç»“æœ â†’ å…³é—­é¡µé¢
}
```

**é…ç½®ç®¡ç†**:
```kotlin
// SharedPreferenceså­˜å‚¨
KEY_USER_CHOICE          // ç”¨æˆ·é€‰æ‹©
KEY_WELCOME_VERSION      // æ¬¢è¿é¡µç‰ˆæœ¬
KEY_CHOICE_TIMESTAMP     // é€‰æ‹©æ—¶é—´æˆ³

// ç”¨æˆ·é€‰æ‹©æšä¸¾
enum class UserChoice {
    NONE,    // æœªé€‰æ‹©
    LOCAL,   // æœ¬åœ°æ¨¡å¼
    CLOUD    // äº‘ç«¯æ¨¡å¼
}
```

---

### 6. Nativeæ ¸å¿ƒæ¨¡å—è¯¦è§£

#### 6.1 gjduixæ ¸å¿ƒ (duix/)

**æ–‡ä»¶**: `gjduix.cpp`, `gjsimp.cpp`

**èŒè´£**: Nativeå±‚ä¸»æ§é€»è¾‘

**æ ¸å¿ƒå‡½æ•°**:
```cpp
// åˆå§‹åŒ–
int gjduix_init(const char* model_path, callback_func cb);

// éŸ³é¢‘å¤„ç†
int gjduix_push_audio(const uint8_t* pcm, int len);

// æ¸²æŸ“
int gjduix_render(uint8_t* rgba_out, int* width, int* height);

// åŠ¨ä½œæ§åˆ¶
int gjduix_start_motion(const char* motion_name, bool immediate);
int gjduix_random_motion();

// æ¸…ç†
void gjduix_release();
```

#### 6.2 dhcoreæ ¸å¿ƒåº“ (dhcore/)

**èŒè´£**: åŸºç¡€æ•°æ®ç»“æ„å’Œå†…å­˜ç®¡ç†

**ä¸»è¦ç»„ä»¶**:
- `dh_mem`: å†…å­˜æ± ç®¡ç†
- `dh_data`: æ•°æ®ç¼“å†²åŒº
- `dh_que`: çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—
- `concurrentqueue`: æ— é”å¹¶å‘é˜Ÿåˆ—

#### 6.3 dhmfccéŸ³é¢‘æ¨¡å— (dhmfcc/)

**èŒè´£**: éŸ³é¢‘ç‰¹å¾æå–

**å¤„ç†æµç¨‹**:
```
PCMéŸ³é¢‘ (16kHz, 16bit, Mono)
    â†“
dhpcm.cpp (é¢„å¤„ç†)
    â”œâ”€ éŸ³é¢‘åˆ†å¸§
    â”œâ”€ é¢„åŠ é‡
    â””â”€ çª—å‡½æ•°
    â†“
AudioFFT.cpp (é¢‘åŸŸåˆ†æ)
    â”œâ”€ FFTå˜æ¢
    â””â”€ åŠŸç‡è°±
    â†“
iir_filter.cpp (æ»¤æ³¢)
    â”œâ”€ Melæ»¤æ³¢å™¨ç»„
    â””â”€ é¢‘ç‡æ˜ å°„
    â†“
mfcc.cpp (ç‰¹å¾æå–)
    â”œâ”€ DCTå˜æ¢
    â””â”€ MFCCç³»æ•°
    â†“
dhwenet.cpp (AIå¢å¼º)
    â”œâ”€ WeNetæ¨¡å‹
    â””â”€ ç‰¹å¾ä¼˜åŒ–
    â†“
è¾“å‡º: éŸ³é¢‘ç‰¹å¾å‘é‡
```

#### 6.4 dhunet AIæ¨¡å— (dhunet/)

**èŒè´£**: AIæ¨¡å‹æ¨ç†å’Œå›¾åƒç”Ÿæˆ

**æ ¸å¿ƒç»„ä»¶**:
```cpp
munet.cpp/h         // UNetæ¨¡å‹æ¨ç†
â”œâ”€ åŠ è½½NCNN/ONNXæ¨¡å‹
â”œâ”€ å‰å‘æ¨ç†
â””â”€ è¾“å‡ºå›¾åƒç‰¹å¾

malpha.cpp/h        // Alphaé€šé“å¤„ç†
â”œâ”€ é€æ˜åº¦æ··åˆ
â””â”€ è¾¹ç¼˜æŠ—é”¯é½¿

blendgram.cpp/h     // æ··åˆå›¾å¤„ç†
â”œâ”€ å¤šå±‚æ··åˆ
â””â”€ åŠ¨æ€æƒé‡

jmat.cpp/h          // çŸ©é˜µè¿ç®—
â”œâ”€ çŸ©é˜µä¹˜æ³•
â”œâ”€ ä»¿å°„å˜æ¢
â””â”€ æ’å€¼

face_utils.cpp/h    // äººè„¸å·¥å…·
â”œâ”€ å…³é”®ç‚¹æ£€æµ‹
â””â”€ é¢éƒ¨åŒºåŸŸå®šä½
```

---

## æ–‡ä»¶åŠŸèƒ½è¯´æ˜

### Java/Kotlinæ ¸å¿ƒç±»åŠŸèƒ½è¯¦è§£

#### SDKæ ¸å¿ƒåŒ… (duix-sdk/sdk/client/)

| æ–‡ä»¶ | ç±»å‹ | ä¸»è¦åŠŸèƒ½ | å…³é”®æ–¹æ³• |
|------|------|---------|---------|
| **DUIX.java** | ä¸»æ§ç±» | SDKç»Ÿä¸€å…¥å£ï¼Œç®¡ç†æ¸²æŸ“çº¿ç¨‹å’Œæ¨¡å‹ç”Ÿå‘½å‘¨æœŸ | `init()`, `playAudio()`, `startMotion()`, `release()` |
| **Callback.java** | æ¥å£ | äº‹ä»¶å›è°ƒæ¥å£å®šä¹‰ | `onEvent(int event, String msg, Object info)` |
| **Constant.java** | å¸¸é‡ç±» | å®šä¹‰æ‰€æœ‰äº‹ä»¶å¸¸é‡å’Œé…ç½®å¸¸é‡ | äº‹ä»¶ç ã€çŠ¶æ€ç å®šä¹‰ |
| **VirtualModelUtil.java** | å·¥å…·ç±» | æ¨¡å‹ä¸‹è½½ã€è§£å‹ã€æ ¡éªŒç®¡ç† | `checkModel()`, `modelDownload()`, `baseConfigDownload()` |

#### æ§åˆ¶å™¨åŒ… (controller/) - 2025-10-02æ–°å¢

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **DUIXAudioController.java** | éŸ³é¢‘æ§åˆ¶å™¨ | ç®¡ç†éŸ³é¢‘æ’­æ”¾ã€PCMæ¨é€ã€éŸ³é‡æ§åˆ¶ |
| **DUIXInitializer.java** | åˆå§‹åŒ–å™¨ | è´Ÿè´£æ¨¡å‹æ–‡ä»¶æ£€æŸ¥å’Œåˆå§‹åŒ–å‡†å¤‡ |
| **DUIXMotionController.java** | åŠ¨ä½œæ§åˆ¶å™¨ | ç®¡ç†æ•°å­—äººåŠ¨ä½œæ’­æ”¾ |

#### éŸ³é¢‘åŒ… (audio/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **AudioPlayer.java** | éŸ³é¢‘æ’­æ”¾å™¨ | ä½¿ç”¨AudioTrackæ’­æ”¾PCMéŸ³é¢‘ï¼Œæ”¯æŒéŸ³é‡æ§åˆ¶å’Œæ’­æ”¾æ§åˆ¶ |

#### æ•°æ®æ¨¡å‹åŒ… (bean/)

| æ–‡ä»¶ | åŠŸèƒ½ | å­—æ®µ |
|------|------|------|
| **ImageFrame.java** | å›¾åƒå¸§æ•°æ® | `byte[] data`, `int width`, `int height`, `int format` |
| **AudioFrame.java** | éŸ³é¢‘å¸§æ•°æ® | `byte[] pcm`, `int length`, `long timestamp` |

#### å›½é™…åŒ–åŒ… (i18n/) - 2025-10-02æ–°å¢

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **LanguageManager.kt** | è¯­è¨€ç®¡ç†å™¨ | ç®¡ç†åº”ç”¨è¯­è¨€è®¾ç½®ã€æŒä¹…åŒ–ã€ç³»ç»Ÿè¯­è¨€æ£€æµ‹ |

**LanguageManageræ ¸å¿ƒåŠŸèƒ½**:
```kotlin
object LanguageManager {
    // æ”¯æŒçš„è¯­è¨€
    enum class Language(val code: String, val displayName: String, val locale: Locale) {
        CHINESE("zh", "ä¸­æ–‡", Locale.SIMPLIFIED_CHINESE),
        ENGLISH("en", "English", Locale.ENGLISH)
    }

    // è·å–å½“å‰è¯­è¨€
    fun getCurrentLanguage(context: Context): Language

    // è®¾ç½®è¯­è¨€
    fun setLanguage(context: Context, language: Language)

    // è·å–ç³»ç»Ÿè¯­è¨€
    fun getSystemLanguage(): Language

    // åº”ç”¨è¯­è¨€åˆ°Context
    fun applyLanguage(context: Context): Context
}
```

#### ç½‘ç»œåŒ… (net/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **FileDownloader.java** | æ–‡ä»¶ä¸‹è½½å™¨ | åŸºäºOkHttpçš„æ–­ç‚¹ç»­ä¼ ä¸‹è½½å™¨ï¼Œæ”¯æŒè¿›åº¦å›è°ƒ |
| **DownloadZipService.java** | ZIPä¸‹è½½æœåŠ¡ | ä¸“é—¨ç”¨äºä¸‹è½½å’Œå¤„ç†ZIPæ ¼å¼çš„æ¨¡å‹æ–‡ä»¶ |

#### æ¸²æŸ“åŒ… (render/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **DUIXRenderer.java** | OpenGLæ¸²æŸ“å™¨ | å®ç°GLSurfaceView.Rendererï¼Œè´Ÿè´£OpenGLæ¸²æŸ“ç®¡çº¿ |
| **DUIXTextureView.java** | çº¹ç†è§†å›¾ | è‡ªå®šä¹‰TextureViewï¼Œæ”¯æŒé€æ˜èƒŒæ™¯å’Œç¡¬ä»¶åŠ é€Ÿ |
| **ImageDrawer.java** | å›¾åƒç»˜åˆ¶å™¨ | å°è£…OpenGLç»˜åˆ¶é€»è¾‘ï¼Œç®¡ç†Shaderå’Œçº¹ç† |
| **TextureMatrix.java** | çº¹ç†çŸ©é˜µ | çº¹ç†åæ ‡å˜æ¢çŸ©é˜µç®¡ç† |
| **RenderSink.java** | æ¸²æŸ“æ¥å£ | æ¸²æŸ“æ•°æ®æ¥æ”¶å™¨æ¥å£ï¼Œè§£è€¦æ¸²æŸ“å’Œæ•°æ®æº |

#### çº¿ç¨‹åŒ… (thread/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **RenderThread.java** | æ¸²æŸ“çº¿ç¨‹ | æ ¸å¿ƒæ¸²æŸ“çº¿ç¨‹ï¼Œç®¡ç†Nativeäº¤äº’ã€éŸ³é¢‘é˜Ÿåˆ—ã€å¸§æ¸²æŸ“ |

#### å·¥å…·åŒ… (util/)

| æ–‡ä»¶ | åŠŸèƒ½ | ä¸»è¦æ–¹æ³• |
|------|------|---------|
| **DeviceUtils.java** | è®¾å¤‡ä¿¡æ¯ | `getCPUInfo()`, `getMemoryInfo()`, `getVersionName()` |
| **FileUtil.java** | æ–‡ä»¶æ“ä½œ | `copyFile()`, `deleteDir()`, `getFileSize()` |
| **Logger.java** | æ—¥å¿—å·¥å…· | `d()`, `i()`, `w()`, `e()` - ç»Ÿä¸€æ—¥å¿—æ¥å£ |
| **MD5Util.java** | MD5è®¡ç®— | `getMD5(File)`, `getMD5(String)` - æ–‡ä»¶æ ¡éªŒ |
| **OpenGLUtil.java** | OpenGLå·¥å…· | `createProgram()`, `loadShader()`, `checkError()` |
| **SystemUtils.java** | ç³»ç»Ÿå·¥å…· | `getVersionCode()`, `getVersionName()`, `compareVersion()` |
| **ZipUtil.java** | ZIPå·¥å…· | `unzip()`, `zipFiles()` - å‹ç¼©è§£å‹ |

#### æ¬¢è¿é¡µåŒ… (welcome/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **WelcomeActivity.kt** | æ¬¢è¿é¡µActivity | WebViewåŠ è½½æ¬¢è¿é¡µï¼Œå¤„ç†ç”¨æˆ·é€‰æ‹©ï¼Œæ”¯æŒåŠ¨ç”»æ•ˆæœå’Œå›½é™…åŒ– |
| **WelcomeConfig.kt** | é…ç½®ç®¡ç† | SharedPreferencesæŒä¹…åŒ–ç”¨æˆ·é€‰æ‹©å’Œç‰ˆæœ¬ä¿¡æ¯ |
| **WelcomeIntegrationExample.kt** | é›†æˆç¤ºä¾‹ | å±•ç¤ºå¦‚ä½•åœ¨åº”ç”¨ä¸­é›†æˆæ¬¢è¿é¡µåŠŸèƒ½ |

#### æ¬¢è¿é¡µèµ„æº (assets/welcome/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **welcome.html** | æ¬¢è¿é¡µUIç•Œé¢ | ç°ä»£åŒ–è®¾è®¡ï¼ŒåŒ…å«åŠ¨æ€æ¸å˜èƒŒæ™¯ã€æ¯›ç»ç’ƒå¡ç‰‡ã€æµç•…åŠ¨ç”»ã€å‘¼å¸å…‰ç¯æ•ˆæœï¼ˆ2025-10-02ç¾åŒ–å‡çº§ï¼‰ |
| **js/welcome.js** | äº¤äº’è„šæœ¬ | å¤„ç†ç”¨æˆ·ç‚¹å‡»äº‹ä»¶ï¼Œé€šè¿‡AndroidBridgeä¸åŸç”Ÿå±‚é€šä¿¡ |
| **js/i18n.js** | å›½é™…åŒ–è„šæœ¬ | ç®¡ç†é¡µé¢æ–‡æœ¬å›½é™…åŒ–ï¼Œæ”¯æŒä¸­è‹±æ–‡åˆ‡æ¢ï¼ˆ2025-10-02æ–°å¢ï¼‰ |
| **css/tailwind.min.css** | Tailwind CSS | æä¾›åŸºç¡€æ ·å¼æ¡†æ¶ |
| **css/welcome.css** | æ¬¢è¿é¡µæ ·å¼ | è‡ªå®šä¹‰æ ·å¼ã€åŠ¨ç”»å®šä¹‰ã€å“åº”å¼è®¾è®¡ |

**welcome.htmlæ ¸å¿ƒç‰¹æ€§**:
- **æ¸å˜èƒŒæ™¯**: ç´«è‰²ç³»åŠ¨æ€æ¸å˜(`#667eea` â†’ `#764ba2` â†’ `#f093fb`)ï¼Œ15ç§’å¾ªç¯
- **æ¯›ç»ç’ƒå¡ç‰‡**: `backdrop-filter: blur(10px)` + 95%ç™½è‰²èƒŒæ™¯
- **é¡µé¢åŠ è½½åŠ¨ç”»**: fadeInDown(Logo/æ ‡é¢˜) + fadeInUp(å¡ç‰‡) + fadeIn(åº•éƒ¨)
- **äº¤äº’åé¦ˆ**: æ‚¬æµ®ä¸Šæµ®5px + ç¼©æ”¾1.02å€ï¼Œç‚¹å‡»ç¼©æ”¾0.98å€
- **å‘¼å¸å…‰ç¯**: LogoèƒŒæ™¯2ç§’pulseåŠ¨ç”»
- **è£…é¥°å…ƒç´ **: 3ä¸ªæµ®åŠ¨åŠé€æ˜åœ†å½¢ï¼Œ20ç§’floatåŠ¨ç”»
- **å“åº”å¼è®¾è®¡**: â‰¤640pxå°å±ã€641-1024pxä¸­å±è‡ªé€‚åº”
- **æ€§èƒ½ä¼˜åŒ–**: GPUåŠ é€Ÿå±æ€§(transform/opacity)ï¼Œé¿å…é‡æ’
- **å›½é™…åŒ–æ”¯æŒ**: é€šè¿‡i18n.jså®ç°ä¸­è‹±æ–‡åˆ‡æ¢ï¼ˆ2025-10-02æ–°å¢ï¼‰

---

### Nativeæ ¸å¿ƒæ–‡ä»¶åŠŸèƒ½è¯¦è§£

#### Android JNIå±‚ (android/)

| æ–‡ä»¶ | åŠŸèƒ½ | å…³é”®å‡½æ•° |
|------|------|---------|
| **DuixJni.cpp** | JNIæ¥å£å®ç° | `Java_*_duixInit()`, `Java_*_duixPushAudio()`, `Java_*_duixRender()` |
| **JniHelper.cpp/h** | JNIè¾…åŠ©å·¥å…· | ç±»å‹è½¬æ¢ã€å¼‚å¸¸å¤„ç†ã€å¼•ç”¨ç®¡ç† |
| **Log.cpp/h** | Nativeæ—¥å¿— | `LOGD()`, `LOGI()`, `LOGW()`, `LOGE()` å®å®šä¹‰ |

#### DUIXæ ¸å¿ƒ (duix/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **gjduix.cpp/h** | DUIXä¸»å®ç° | æ¨¡å‹åŠ è½½ã€éŸ³é¢‘å¤„ç†ã€å›¾åƒæ¸²æŸ“ã€åŠ¨ä½œæ§åˆ¶çš„å®Œæ•´å®ç° |
| **gjsimp.cpp** | ç®€åŒ–æ¥å£ | æä¾›æ›´ç®€å•çš„Cæ¥å£å°è£…ï¼Œä¾¿äºå…¶ä»–è¯­è¨€è°ƒç”¨ |

#### æ ¸å¿ƒåº“ (dhcore/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **dh_mem.c/h** | å†…å­˜ç®¡ç† | å†…å­˜æ± ã€å¯¹è±¡æ± ã€æ™ºèƒ½æŒ‡é’ˆ |
| **dh_data.cpp/h** | æ•°æ®ç»“æ„ | åŠ¨æ€æ•°ç»„ã€ç¼“å†²åŒºç®¡ç† |
| **dh_que.cpp/h** | é˜Ÿåˆ—å®ç° | çº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ã€ç¯å½¢ç¼“å†²åŒº |
| **concurrentqueue.h** | æ— é”é˜Ÿåˆ— | é«˜æ€§èƒ½å¹¶å‘é˜Ÿåˆ—ï¼ˆç¬¬ä¸‰æ–¹ï¼‰ |
| **readerwriterqueue.h** | è¯»å†™é˜Ÿåˆ— | å•ç”Ÿäº§è€…å•æ¶ˆè´¹è€…æ— é”é˜Ÿåˆ— |

#### éŸ³é¢‘æ¨¡å— (dhmfcc/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **dhpcm.cpp/h** | PCMå¤„ç† | PCMéŸ³é¢‘é¢„å¤„ç†ã€åˆ†å¸§ã€çª—å‡½æ•° |
| **dhwenet.cpp/h** | WeNeté›†æˆ | é›†æˆWeNetè¯­éŸ³è¯†åˆ«æ¨¡å‹ |
| **wenetai.cpp/h** | AIæ¥å£ | WeNetæ¨ç†æ¥å£å°è£… |
| **AudioFFT.cpp** | FFTå˜æ¢ | å¿«é€Ÿå‚…é‡Œå¶å˜æ¢å®ç° |
| **iir_filter.cpp** | IIRæ»¤æ³¢ | æ— é™è„‰å†²å“åº”æ»¤æ³¢å™¨ |
| **mfcc.cpp** | MFCCæå– | Melé¢‘ç‡å€’è°±ç³»æ•°æå– |

#### AIæ¨ç†æ¨¡å— (dhunet/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **munet.cpp/h** | UNetæ¨ç† | U-Netæ¨¡å‹æ¨ç†ï¼Œç”Ÿæˆå›¾åƒå’Œæƒé‡ |
| **malpha.cpp/h** | Alphaå¤„ç† | é€æ˜é€šé“å¤„ç†ã€Alphaæ··åˆ |
| **blendgram.cpp/h** | æ··åˆå¤„ç† | å¤šå±‚çº¹ç†æ··åˆã€åŠ¨æ€æƒé‡ |
| **jmat.cpp/h** | çŸ©é˜µè¿ç®— | çŸ©é˜µè¿ç®—ã€ä»¿å°„å˜æ¢ |
| **face_utils.cpp/h** | äººè„¸å·¥å…· | äººè„¸å…³é”®ç‚¹ã€é¢éƒ¨åŒºåŸŸå¤„ç† |

#### åŠ å¯†æ¨¡å— (aes/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **aes_core.c** | AESæ ¸å¿ƒ | AESåŠ å¯†ç®—æ³•æ ¸å¿ƒå®ç° |
| **aes_cbc.c** | CBCæ¨¡å¼ | å¯†ç åˆ†ç»„é“¾æ¥æ¨¡å¼ |
| **aes_ecb.c** | ECBæ¨¡å¼ | ç”µå­å¯†ç æœ¬æ¨¡å¼ |
| **gj_aes.c/h** | è‡ªå®šä¹‰AES | å°è£…çš„AESæ¥å£ |
| **gaes_stream.cc/h** | AESæµ | æµå¼AESåŠ è§£å¯† |
| **base64.c/h** | Base64 | Base64ç¼–è§£ç  |

---

### Testæ¨¡å—æ–‡ä»¶åŠŸèƒ½

#### Activityå±‚ (ui/activity/)

| æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|------|------|------|
| **MainActivity.kt** | ä¸»ç•Œé¢ | è·¯ç”±é€»è¾‘ï¼Œæ ¹æ®ç”¨æˆ·é€‰æ‹©è·³è½¬åˆ°æœ¬åœ°/äº‘ç«¯ç•Œé¢ |
| **BaseActivity.java** | åŸºç¡€Activity | æƒé™ç®¡ç†ã€ç”Ÿå‘½å‘¨æœŸç®¡ç†ã€è¯­è¨€è®¾ç½® |
| **local/LocalMainActivity.kt** | æœ¬åœ°é…ç½®ç•Œé¢ | æ¨¡å‹é€‰æ‹©ã€ä¸‹è½½ã€é…ç½®ï¼Œç°ä»£åŒ–UIè®¾è®¡ï¼ˆ2025-10-02é‡æ„ï¼‰ |
| **local/LocalCallActivity.kt** | æœ¬åœ°æ’­æ”¾ç•Œé¢ | æ•°å­—äººæ¸²æŸ“ã€éŸ³é¢‘æ’­æ”¾ã€åŠ¨ä½œæ§åˆ¶ã€è°ƒè¯•ä¿¡æ¯ |
| **cloud/CloudMainActivity.kt** | äº‘ç«¯ç•Œé¢ | äº‘ç«¯æ•°å­—äººå ä½ç•Œé¢ï¼ˆå¾…å¼€å‘ï¼‰ï¼ˆ2025-10-02æ–°å¢ï¼‰ |

#### UIç»„ä»¶ (ui/)

| ç›®å½•/æ–‡ä»¶ | åŠŸèƒ½ | è¯´æ˜ |
|----------|------|------|
| **adapter/** | é€‚é…å™¨ | RecyclerViewé€‚é…å™¨ |
| - ModelSelectorAdapter.kt | æ¨¡å‹é€‰æ‹© | æ˜¾ç¤ºå¯ç”¨æ¨¡å‹åˆ—è¡¨ |
| - MotionAdapter.kt | åŠ¨ä½œé€‰æ‹© | æ˜¾ç¤ºå¯ç”¨åŠ¨ä½œåˆ—è¡¨ |
| **dialog/** | å¯¹è¯æ¡† | å„ç±»å¯¹è¯æ¡† |
| - LoadingDialog.kt | åŠ è½½å¯¹è¯æ¡† | æ˜¾ç¤ºä¸‹è½½/åŠ è½½è¿›åº¦ |
| - AudioRecordDialog.kt | å½•éŸ³å¯¹è¯æ¡† | éŸ³é¢‘å½•åˆ¶å’Œæ’­æ”¾ |
| - ModelSelectorDialog.kt | æ¨¡å‹é€‰æ‹© | æ¨¡å‹é€‰æ‹©å¼¹çª— |
| - LanguageSelectorDialog.kt | è¯­è¨€é€‰æ‹© | è¯­è¨€åˆ‡æ¢å¯¹è¯æ¡†ï¼ˆ2025-10-02æ–°å¢ï¼‰ |

#### å…¶ä»–æ¨¡å— (test/)

| ç›®å½• | åŠŸèƒ½ | ä¸»è¦æ–‡ä»¶ |
|------|------|---------|
| **audio/** | éŸ³é¢‘å½•åˆ¶ | AudioRecorder.java - Androidå½•éŸ³å™¨å°è£… |
| **net/** | ç½‘ç»œä¸‹è½½ | SyncDownloadFile.java - åŒæ­¥ä¸‹è½½ |
| **render/** | è°ƒè¯•æ¸²æŸ“ | DebugSink.java - è°ƒè¯•ç”¨æ¸²æŸ“æ¥æ”¶å™¨ |
| **service/** | æœåŠ¡å±‚ | StorageService.java - å­˜å‚¨ç®¡ç†æœåŠ¡ |
| **util/** | å·¥å…·ç±» | å­—ç¬¦ä¸²ã€ç³»ç»Ÿã€ZIPå·¥å…· |

---

## å›½é™…åŒ–ç³»ç»Ÿ

### æ¦‚è¿°

é¡¹ç›®äº2025-10-02å®ç°äº†å®Œæ•´çš„å›½é™…åŒ–ç³»ç»Ÿï¼Œæ”¯æŒä¸­è‹±æ–‡åŒè¯­åˆ‡æ¢ã€‚

### æ¶æ„è®¾è®¡

```
å›½é™…åŒ–ç³»ç»Ÿæ¶æ„
â”œâ”€ Java/Kotlinå±‚
â”‚   â””â”€ LanguageManager.kt (è¯­è¨€ç®¡ç†å™¨)
â”‚       â”œâ”€ è¯­è¨€æšä¸¾å®šä¹‰
â”‚       â”œâ”€ SharedPreferencesæŒä¹…åŒ–
â”‚       â”œâ”€ Contextè¯­è¨€åº”ç”¨
â”‚       â””â”€ ç³»ç»Ÿè¯­è¨€æ£€æµ‹
â”‚
â”œâ”€ Androidèµ„æºå±‚
â”‚   â”œâ”€ res/values/strings.xml           (é»˜è®¤ä¸­æ–‡)
â”‚   â”œâ”€ res/values-zh-rCN/strings.xml    (ç®€ä½“ä¸­æ–‡)
â”‚   â””â”€ res/values-en/strings.xml        (è‹±æ–‡)
â”‚
â””â”€ JavaScriptå±‚
    â””â”€ assets/welcome/js/i18n.js (æ¬¢è¿é¡µå›½é™…åŒ–)
        â”œâ”€ ç¿»è¯‘å­—å…¸
        â”œâ”€ è¯­è¨€æ£€æµ‹
        â””â”€ DOMæ›´æ–°
```

### LanguageManagerå®ç°

**ä½ç½®**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/i18n/LanguageManager.kt`

```kotlin
object LanguageManager {
    private const val PREF_NAME = "language_settings"
    private const val KEY_LANGUAGE = "current_language"

    /**
     * æ”¯æŒçš„è¯­è¨€æšä¸¾
     */
    enum class Language(val code: String, val displayName: String, val locale: Locale) {
        CHINESE("zh", "ä¸­æ–‡", Locale.SIMPLIFIED_CHINESE),
        ENGLISH("en", "English", Locale.ENGLISH);

        companion object {
            fun fromCode(code: String): Language {
                return values().find { it.code == code } ?: getSystemLanguage()
            }

            fun getSystemLanguage(): Language {
                val systemLocale = if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.N) {
                    Resources.getSystem().configuration.locales[0]
                } else {
                    Resources.getSystem().configuration.locale
                }
                return when (systemLocale.language) {
                    "zh" -> CHINESE
                    "en" -> ENGLISH
                    else -> CHINESE
                }
            }
        }
    }

    /**
     * è·å–å½“å‰è¯­è¨€
     */
    fun getCurrentLanguage(context: Context): Language {
        val prefs = context.getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE)
        val languageCode = prefs.getString(KEY_LANGUAGE, null)
        return if (languageCode != null) {
            Language.fromCode(languageCode)
        } else {
            Language.getSystemLanguage()
        }
    }

    /**
     * è®¾ç½®è¯­è¨€
     */
    fun setLanguage(context: Context, language: Language) {
        val prefs = context.getSharedPreferences(PREF_NAME, Context.MODE_PRIVATE)
        prefs.edit().putString(KEY_LANGUAGE, language.code).apply()
    }

    /**
     * åº”ç”¨è¯­è¨€åˆ°Context
     */
    fun applyLanguage(context: Context): Context {
        val language = getCurrentLanguage(context)
        val locale = language.locale
        Locale.setDefault(locale)

        val config = Configuration(context.resources.configuration)
        config.setLocale(locale)

        return context.createConfigurationContext(config)
    }
}
```

### æ¬¢è¿é¡µå›½é™…åŒ–

**ä½ç½®**: `duix-sdk/src/main/assets/welcome/js/i18n.js`

```javascript
const i18n = {
    // ç¿»è¯‘å­—å…¸
    translations: {
        zh: {
            title: "é€‰æ‹©æ‚¨çš„æ•°å­—äººæ¨¡å¼",
            subtitle: "é€‰æ‹©é€‚åˆæ‚¨çš„ä½¿ç”¨åœºæ™¯",
            localTitle: "æœ¬åœ°æ•°å­—äºº",
            localDesc: "çº¯ç¦»çº¿è¿è¡Œï¼Œéšç§å®‰å…¨",
            cloudTitle: "äº‘ç«¯æ•°å­—äºº",
            cloudDesc: "äº‘ç«¯ç®—åŠ›ï¼ŒåŠŸèƒ½å¼ºå¤§",
            footer: "Powered by DUIX SDK"
        },
        en: {
            title: "Choose Your Digital Human Mode",
            subtitle: "Select the scenario that suits you",
            localTitle: "Local Digital Human",
            localDesc: "Pure offline, privacy secure",
            cloudTitle: "Cloud Digital Human",
            cloudDesc: "Cloud computing, powerful functions",
            footer: "Powered by DUIX SDK"
        }
    },

    // å½“å‰è¯­è¨€
    currentLanguage: 'zh',

    // åˆå§‹åŒ–
    init() {
        // ä»Androidè·å–å½“å‰è¯­è¨€
        if (typeof AndroidBridge !== 'undefined' && AndroidBridge.getCurrentLanguage) {
            this.currentLanguage = AndroidBridge.getCurrentLanguage();
        } else {
            // é™çº§åˆ°æµè§ˆå™¨è¯­è¨€æ£€æµ‹
            const browserLang = navigator.language || navigator.userLanguage;
            this.currentLanguage = browserLang.startsWith('zh') ? 'zh' : 'en';
        }
        this.updatePage();
    },

    // æ›´æ–°é¡µé¢æ–‡æœ¬
    updatePage() {
        const t = this.translations[this.currentLanguage];
        document.querySelectorAll('[data-i18n]').forEach(element => {
            const key = element.getAttribute('data-i18n');
            if (t[key]) {
                element.textContent = t[key];
            }
        });
    },

    // åˆ‡æ¢è¯­è¨€
    switchLanguage(lang) {
        this.currentLanguage = lang;
        this.updatePage();
    }
};

// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', () => {
    i18n.init();
});
```

### è¯­è¨€é€‰æ‹©å¯¹è¯æ¡†

**ä½ç½®**: `test/src/main/java/ai/guiji/duix/test/ui/dialog/LanguageSelectorDialog.kt`

```kotlin
class LanguageSelectorDialog(
    context: Context,
    private val currentLanguage: LanguageManager.Language,
    private val onLanguageSelected: (LanguageManager.Language) -> Unit
) : AlertDialog(context) {

    override fun onCreate(savedInstanceState: Bundle?) {
        super.onCreate(savedInstanceState)

        val languages = LanguageManager.Language.values()
        val items = languages.map { it.displayName }.toTypedArray()
        val checkedItem = languages.indexOf(currentLanguage)

        AlertDialog.Builder(context)
            .setTitle(R.string.select_language)
            .setSingleChoiceItems(items, checkedItem) { dialog, which ->
                val selectedLanguage = languages[which]
                onLanguageSelected(selectedLanguage)
                dialog.dismiss()
            }
            .setNegativeButton(R.string.cancel, null)
            .show()
    }
}
```

### ä½¿ç”¨ç¤ºä¾‹

#### åœ¨Activityä¸­åº”ç”¨è¯­è¨€

```kotlin
class BaseActivity : AppCompatActivity() {
    override fun attachBaseContext(newBase: Context) {
        super.attachBaseContext(LanguageManager.applyLanguage(newBase))
    }
}
```

#### è¯­è¨€åˆ‡æ¢

```kotlin
// åœ¨MainActivityä¸­
binding.btnLanguage.setOnClickListener {
    val currentLang = LanguageManager.getCurrentLanguage(this)
    LanguageSelectorDialog(this, currentLang) { selectedLang ->
        LanguageManager.setLanguage(this, selectedLang)
        // é‡å¯Activityä»¥åº”ç”¨æ–°è¯­è¨€
        recreate()
    }.show()
}
```

### èµ„æºæ–‡ä»¶ç»“æ„

```
test/src/main/res/
â”œâ”€â”€ values/strings.xml              # é»˜è®¤ï¼ˆä¸­æ–‡ï¼‰
â”œâ”€â”€ values-zh-rCN/strings.xml       # ç®€ä½“ä¸­æ–‡
â””â”€â”€ values-en/strings.xml           # è‹±æ–‡
```

**ç¤ºä¾‹å­—ç¬¦ä¸²èµ„æº**:

```xml
<!-- values/strings.xml (é»˜è®¤ä¸­æ–‡) -->
<resources>
    <string name="app_name">DUIXæ•°å­—äºº</string>
    <string name="select_language">é€‰æ‹©è¯­è¨€</string>
    <string name="local_mode">æœ¬åœ°æ¨¡å¼</string>
    <string name="cloud_mode">äº‘ç«¯æ¨¡å¼</string>
</resources>

<!-- values-en/strings.xml -->
<resources>
    <string name="app_name">DUIX Digital Human</string>
    <string name="select_language">Select Language</string>
    <string name="local_mode">Local Mode</string>
    <string name="cloud_mode">Cloud Mode</string>
</resources>
```

### å›½é™…åŒ–å®ç°ç‰¹ç‚¹

- âœ… **ç»Ÿä¸€ç®¡ç†**: LanguageManageré›†ä¸­ç®¡ç†è¯­è¨€è®¾ç½®
- âœ… **æŒä¹…åŒ–**: SharedPreferencesä¿å­˜ç”¨æˆ·é€‰æ‹©
- âœ… **ç³»ç»Ÿæ„ŸçŸ¥**: è‡ªåŠ¨æ£€æµ‹ç³»ç»Ÿè¯­è¨€ä½œä¸ºé»˜è®¤å€¼
- âœ… **å…¨å±€åº”ç”¨**: é€šè¿‡attachBaseContextåœ¨æ‰€æœ‰Activityç”Ÿæ•ˆ
- âœ… **æ¬¢è¿é¡µæ”¯æŒ**: JavaScriptå±‚ç‹¬ç«‹å®ç°å›½é™…åŒ–
- âœ… **ç±»å‹å®‰å…¨**: ä½¿ç”¨æšä¸¾ç±»å‹é¿å…é­”æ³•å­—ç¬¦ä¸²
- âœ… **æ˜“äºæ‰©å±•**: æ·»åŠ æ–°è¯­è¨€åªéœ€æ‰©å±•æšä¸¾å’Œèµ„æºæ–‡ä»¶

---

## ç›®å½•è§£è€¦åˆ†æ

### æ•´ä½“æ¶æ„è¯„ä¼°

é¡¹ç›®é‡‡ç”¨**æ¨¡å—åŒ–åˆ†å±‚æ¶æ„**ï¼Œæ•´ä½“è§£è€¦ç¨‹åº¦**è‰¯å¥½**ï¼Œç»è¿‡2025-10-02çš„é‡æ„åè¿›ä¸€æ­¥æå‡ã€‚

#### âœ… ä¼˜ç‚¹

1. **æ¨¡å—ç‹¬ç«‹æ€§å¼º**
   - `duix-sdk`å’Œ`test`æ¨¡å—å®Œå…¨ç‹¬ç«‹
   - SDKå¯ä»¥ç‹¬ç«‹ç¼–è¯‘ä¸ºAARå‘å¸ƒ
   - testæ¨¡å—ä»…ä¾èµ–SDKå…¬å¼€API

2. **å±‚æ¬¡åˆ’åˆ†æ¸…æ™°**
   ```
   Application Layer (test)
        â†“ [ä¾èµ–]
   SDK Layer (duix-sdk)
        â†“ [JNI]
   Native Layer (C++)
        â†“ [é“¾æ¥]
   Third-Party Libraries
   ```

3. **åŠŸèƒ½æ¨¡å—åŒ–**ï¼ˆ2025-10-02é‡æ„ï¼‰
   - DUIXä¸»ç±»æ‹†åˆ†ä¸ºå¤šä¸ªæ§åˆ¶å™¨
   - éŸ³é¢‘ã€æ¸²æŸ“ã€ç½‘ç»œã€å·¥å…·å„è‡ªç‹¬ç«‹åŒ…
   - æ¯ä¸ªæ¨¡å—èŒè´£å•ä¸€
   - æ¨¡å—é—´é€šè¿‡æ¥å£é€šä¿¡

4. **æ¥å£æŠ½è±¡è‰¯å¥½**
   - `Callback` - äº‹ä»¶å›è°ƒæ¥å£
   - `RenderSink` - æ¸²æŸ“æ•°æ®æ¥æ”¶æ¥å£
   - `ModelDownloadCallback` - ä¸‹è½½å›è°ƒæ¥å£

5. **å›½é™…åŒ–æ¨¡å—ç‹¬ç«‹**ï¼ˆ2025-10-02æ–°å¢ï¼‰
   - `LanguageManager` - ç‹¬ç«‹çš„è¯­è¨€ç®¡ç†æ¨¡å—
   - ä¸ä¸šåŠ¡é€»è¾‘è§£è€¦
   - æ˜“äºæ‰©å±•æ–°è¯­è¨€

#### âš ï¸ å·²è§£å†³çš„é—®é¢˜ï¼ˆ2025-10-02é‡æ„ï¼‰

1. ~~**DUIXç±»èŒè´£è¿‡é‡**~~ âœ… å·²è§£å†³
   - æ‹†åˆ†ä¸º `DUIXInitializer`, `DUIXAudioController`, `DUIXMotionController`
   - æ¯ä¸ªæ§åˆ¶å™¨èŒè´£å•ä¸€
   - æ˜“äºæµ‹è¯•å’Œç»´æŠ¤

2. ~~**RenderThreadèŒè´£ä»è¾ƒå¤š**~~ âš ï¸ éƒ¨åˆ†æ”¹è¿›
   - å·²é€šè¿‡æ§åˆ¶å™¨æ¨¡å¼è§£è€¦éƒ¨åˆ†åŠŸèƒ½
   - å»ºè®®è¿›ä¸€æ­¥æ‹†åˆ†ä¸ºéŸ³é¢‘é˜Ÿåˆ—ç®¡ç†å™¨ã€Nativeæ¥å£å°è£…ç­‰

#### ğŸ“Š è§£è€¦åº¦è¯„åˆ†

| å±‚çº§ | è§£è€¦åº¦ | è¯„åˆ† | è¯´æ˜ |
|------|--------|------|------|
| **æ¨¡å—çº§** | ä¼˜ç§€ | â­â­â­â­â­ | SDKå’ŒAppå®Œå…¨ç‹¬ç«‹ |
| **åŒ…çº§** | ä¼˜ç§€ | â­â­â­â­â­ | åŠŸèƒ½æ¨¡å—åˆ’åˆ†æ¸…æ™°ï¼ˆ2025-10-02æ”¹è¿›ï¼‰ |
| **ç±»çº§** | è‰¯å¥½ | â­â­â­â­ | å¤§éƒ¨åˆ†ç±»èŒè´£å•ä¸€ï¼ˆ2025-10-02æ”¹è¿›ï¼‰ |
| **æ–¹æ³•çº§** | è‰¯å¥½ | â­â­â­â­ | æ–¹æ³•åŠŸèƒ½å•ä¸€ |
| **Native** | ä¸€èˆ¬ | â­â­â­ | ç¼ºå°‘æ¥å£æŠ½è±¡ |

**ç»¼åˆè¯„åˆ†**: â­â­â­â­Â½ (4.5/5æ˜Ÿ) - 2025-10-02æå‡0.5æ˜Ÿ

---

### ä¾èµ–æ–¹å‘åˆ†æ

```
testæ¨¡å—ä¾èµ–å…³ç³»:
test/
â”œâ”€ [âœ…æ­£å‘] â†’ duix-sdk (æ¨¡å—ä¾èµ–)
â”œâ”€ [âœ…æ­£å‘] â†’ AndroidX (ç³»ç»Ÿåº“)
â”œâ”€ [âœ…æ­£å‘] â†’ Glide (ç¬¬ä¸‰æ–¹)
â””â”€ [âœ…æ­£å‘] â†’ OkHttp (ç¬¬ä¸‰æ–¹)

duix-sdkä¾èµ–å…³ç³»:
duix-sdk/
â”œâ”€ [âœ…æ­£å‘] â†’ AndroidX (ç³»ç»Ÿåº“)
â”œâ”€ [âœ…æ­£å‘] â†’ Native libs (JNI)
â””â”€ [âŒæ— ä¾èµ–] testæ¨¡å— â† æ­£ç¡®ï¼

Nativeä¾èµ–å…³ç³»:
gjduix.so
â”œâ”€ [âœ…æ­£å‘] â†’ dhcore, dhmfcc, dhunet (é™æ€åº“)
â”œâ”€ [âœ…æ­£å‘] â†’ NCNN, OpenCV, ONNX (ç¬¬ä¸‰æ–¹)
â””â”€ [âœ…æ­£å‘] â†’ ç³»ç»Ÿåº“
```

**âœ… ä¾èµ–æ–¹å‘åˆç†ï¼Œæ— å¾ªç¯ä¾èµ–**

---

### æ”¹è¿›å»ºè®®

#### 1. å¼•å…¥MVVMæ¶æ„ (UIå±‚)

```kotlin
// å½“å‰
LocalCallActivity â†’ ç›´æ¥æ“ä½œ â†’ DUIX

// å»ºè®®
LocalCallActivity â†’ LocalCallViewModel â†’ DUIXRepository â†’ DUIX
         â†“
      LiveData
```

#### 2. ä½¿ç”¨ä¾èµ–æ³¨å…¥

```kotlin
// å½“å‰
val duix = DUIX(context, modelUrl, renderer, callback)

// å»ºè®® (Dagger/Hilt)
@Inject
lateinit var duixFactory: DUIXFactory

val duix = duixFactory.create(modelUrl, renderer, callback)
```

#### 3. ç»Ÿä¸€çŠ¶æ€ç®¡ç†

```kotlin
sealed class DUIXState {
    object Idle : DUIXState()
    object Initializing : DUIXState()
    data class Ready(val modelInfo: ModelInfo) : DUIXState()
    data class Playing(val progress: Float) : DUIXState()
    data class Error(val code: Int, val msg: String) : DUIXState()
}
```

#### 4. äº‹ä»¶æ€»çº¿è§£è€¦

```kotlin
// æ›¿ä»£ç›´æ¥Callback
EventBus.post(DUIXEvent.InitReady(modelInfo))
EventBus.post(DUIXEvent.PlayStart())
```

---

## å¾…å®Œæˆäº‹é¡¹(TODO)

### 1. MainActivity.kt ä¸­çš„TODO

**æ–‡ä»¶**: `test/src/main/java/ai/guiji/duix/test/ui/activity/MainActivity.kt`

| è¡Œå· | TODOå†…å®¹ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| 35 | å¯ä»¥åœ¨è¿™é‡Œé¢„åŠ è½½æœ¬åœ°èµ„æºæˆ–è®¾ç½®ç›¸å…³é…ç½® | ä¸­ | æœ¬åœ°æ¨¡å¼é€‰æ‹©åçš„åˆå§‹åŒ–é€»è¾‘ |
| 39 | å¯ä»¥åœ¨è¿™é‡Œæ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–è®¾ç½®äº‘ç«¯é…ç½® | ä¸­ | äº‘ç«¯æ¨¡å¼é€‰æ‹©åçš„åˆå§‹åŒ–é€»è¾‘ |

**å»ºè®®å®ç°**:
```kotlin
// æœ¬åœ°æ¨¡å¼åˆå§‹åŒ–
when (userChoice) {
    UserChoice.LOCAL -> {
        // é¢„åŠ è½½æœ¬åœ°æ¨¡å‹
        preloadLocalModels()
        // æ£€æŸ¥å­˜å‚¨ç©ºé—´
        checkStorageSpace()
        // è®¾ç½®ç¦»çº¿æ¨¡å¼æ ‡å¿—
        AppConfig.setOfflineMode(true)
    }
    UserChoice.CLOUD -> {
        // æ£€æŸ¥ç½‘ç»œè¿æ¥
        if (!NetworkUtil.isConnected()) {
            showNetworkError()
        }
        // è®¾ç½®äº‘ç«¯APIé…ç½®
        CloudConfig.init()
        // é¢„åŠ è½½äº‘ç«¯èµ„æºåˆ—è¡¨
        fetchCloudResourceList()
    }
}
```

---

### 2. WelcomeConfig.kt ä¸­çš„TODO

**æ–‡ä»¶**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/welcome/WelcomeConfig.kt`

| è¡Œå· | TODOå†…å®¹ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| 14-17 | åç»­å¯æ‰©å±•çš„åŠŸèƒ½<br>- æ”¯æŒå¤šç”¨æˆ·é…ç½®<br>- é…ç½®å¯¼å…¥å¯¼å‡º<br>- åœ¨çº¿é…ç½®åŒæ­¥ | ä½ | æ‰©å±•åŠŸèƒ½è§„åˆ’ |
| 34 | æ”¯æŒç‰ˆæœ¬æ›´æ–°æ£€æµ‹ | ä¸­ | æ¬¢è¿é¡µç‰ˆæœ¬ç®¡ç†æœºåˆ¶ |
| 73 | æ·»åŠ é€‰æ‹©ç»Ÿè®¡å’Œåˆ†æ | ä½ | ç”¨æˆ·è¡Œä¸ºåˆ†æ |
| 128 | æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°æ˜¯å¦éœ€è¦é‡æ–°æ˜¾ç¤ºæ¬¢è¿é¡µé¢ | ä¸­ | ç‰ˆæœ¬æ›´æ–°é€»è¾‘ |
| 159 | é›†æˆåˆ†æSDKï¼Œè®°å½•ç”¨æˆ·é€‰æ‹©è¡Œä¸º | ä½ | æ•°æ®ç»Ÿè®¡é›†æˆ |

---

### 3. WelcomeActivity.kt ä¸­çš„TODO

**æ–‡ä»¶**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/welcome/WelcomeActivity.kt`

| è¡Œå· | TODOå†…å®¹ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| 28-31 | åç»­å¯æ‰©å±•çš„åŠŸèƒ½<br>- é¡µé¢åŠ è½½è¿›åº¦æ˜¾ç¤º<br>- ç½‘ç»œçŠ¶æ€æ£€æµ‹<br>- é”™è¯¯é‡è¯•æœºåˆ¶<br>- ä¸»é¢˜åˆ‡æ¢æ”¯æŒ | ä¸­ | UIåŠŸèƒ½æ‰©å±• |
| 173 | æ·»åŠ é¡µé¢åŠ è½½å®Œæˆçš„åŠ¨ç”»æ•ˆæœ | ä½ | UIä¼˜åŒ– |
| 194 | æ·»åŠ é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶ | é«˜ | é”™è¯¯å¤„ç† |
| 202 | æ·»åŠ è°ƒè¯•æ—¥å¿—æ”¶é›† | ä¸­ | æ—¥å¿—ç®¡ç† |
| 245 | æ·»åŠ é‡è¯•æŒ‰é’®æˆ–fallback UI | é«˜ | ç”¨æˆ·ä½“éªŒ |
| 272 | å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ é¡µé¢åŠ è½½å®Œæˆçš„é¢å¤–å¤„ç† | ä½ | æ‰©å±•ç‚¹ |
| 300 | æ·»åŠ Activityåˆ‡æ¢åŠ¨ç”» | ä½ | UIæ•ˆæœ |

---

### 4. WelcomeIntegrationExample.kt ä¸­çš„TODO

**æ–‡ä»¶**: `duix-sdk/src/main/java/ai/guiji/duix/sdk/welcome/WelcomeIntegrationExample.kt`

| è¡Œå· | TODOå†…å®¹ | ä¼˜å…ˆçº§ | è¯´æ˜ |
|------|---------|--------|------|
| 53 | åœ¨è¿™é‡Œæ·»åŠ æœ¬åœ°æ•°å­—äººåˆå§‹åŒ–é€»è¾‘ | ä¸­ | æœ¬åœ°æ¨¡å¼åˆå§‹åŒ– |
| 58 | åœ¨è¿™é‡Œæ·»åŠ äº‘ç«¯æ•°å­—äººåˆå§‹åŒ–é€»è¾‘ | ä¸­ | äº‘ç«¯æ¨¡å¼åˆå§‹åŒ– |
| 76 | å¯åŠ¨æœ¬åœ°æ•°å­—äººç›¸å…³åŠŸèƒ½ | ä¸­ | æœ¬åœ°åŠŸèƒ½å¯åŠ¨ |
| 81 | å¯åŠ¨äº‘ç«¯æ•°å­—äººç›¸å…³åŠŸèƒ½ | ä¸­ | äº‘ç«¯åŠŸèƒ½å¯åŠ¨ |
| 114 | åœ¨è¿™é‡Œå¯ä»¥è®¾ç½®ä¸€äº›å…¨å±€é…ç½® | ä½ | å…¨å±€é…ç½® |
| 124-130 | åœ¨è¿™é‡Œæ·»åŠ æœ¬åœ°æ•°å­—äººçš„åˆå§‹åŒ–é€»è¾‘ | ä¸­ | æœ¬åœ°åˆå§‹åŒ–è¯¦ç»†å®ç° |
| 137-143 | åœ¨è¿™é‡Œæ·»åŠ äº‘ç«¯æ•°å­—äººçš„åˆå§‹åŒ–é€»è¾‘ | ä¸­ | äº‘ç«¯åˆå§‹åŒ–è¯¦ç»†å®ç° |

**è¿™äº›TODOæ˜¯ç¤ºä¾‹ä»£ç ï¼Œä¾›å¼€å‘è€…å‚è€ƒå®ç°**

---

### TODOç»Ÿè®¡

| æ¨¡å— | TODOæ•°é‡ | é«˜ä¼˜å…ˆçº§ | ä¸­ä¼˜å…ˆçº§ | ä½ä¼˜å…ˆçº§ |
|------|---------|---------|---------|---------|
| **MainActivity** | 2 | 0 | 2 | 0 |
| **WelcomeConfig** | 5 | 0 | 2 | 3 |
| **WelcomeActivity** | 7 | 2 | 2 | 3 |
| **WelcomeExample** | 7 | 0 | 5 | 2 |
| **æ€»è®¡** | **21** | **2** | **11** | **8** |

---

### å»ºè®®å®ç°é¡ºåº

#### Phase 1: é«˜ä¼˜å…ˆçº§ (å¿…é¡»å®Œæˆ)

1. âœ… WelcomeActivityé”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶ (line 194, 245)
   - ç”¨æˆ·ä½“éªŒå…³é”®
   - é˜²æ­¢å› ç½‘ç»œé—®é¢˜å¯¼è‡´åº”ç”¨å´©æºƒ

#### Phase 2: ä¸­ä¼˜å…ˆçº§ (é‡è¦åŠŸèƒ½)

2. âœ… æ¨¡å¼é€‰æ‹©åçš„åˆå§‹åŒ–é€»è¾‘ (MainActivity line 35, 39)
   - å®Œå–„æœ¬åœ°/äº‘ç«¯æ¨¡å¼çš„åˆå§‹åŒ–æµç¨‹

3. âœ… ç‰ˆæœ¬æ›´æ–°æ£€æµ‹æœºåˆ¶ (WelcomeConfig line 34, 128)
   - æ”¯æŒæ¬¢è¿é¡µç‰ˆæœ¬è¿­ä»£

4. âœ… æ—¥å¿—æ”¶é›†å’Œè°ƒè¯• (WelcomeActivity line 202)
   - ä¾¿äºé—®é¢˜æ’æŸ¥

5. âœ… æœ¬åœ°/äº‘ç«¯æ¨¡å¼å®Œæ•´åˆå§‹åŒ– (WelcomeExample)
   - æä¾›å®Œæ•´çš„é›†æˆç¤ºä¾‹

#### Phase 3: ä½ä¼˜å…ˆçº§ (ä¼˜åŒ–åŠŸèƒ½)

6. â³ UIåŠ¨ç”»å’Œæ•ˆæœ (WelcomeActivity line 173, 300)
   - æå‡ç”¨æˆ·ä½“éªŒ

7. â³ æ•°æ®ç»Ÿè®¡åˆ†æ (WelcomeConfig line 73, 159)
   - ç”¨æˆ·è¡Œä¸ºåˆ†æ

8. â³ é…ç½®æ‰©å±•åŠŸèƒ½ (WelcomeConfig line 14-17)
   - å¤šç”¨æˆ·ã€å¯¼å…¥å¯¼å‡ºç­‰é«˜çº§åŠŸèƒ½

---

## æŠ€æœ¯æ ˆ

### å¼€å‘å·¥å…·é“¾

| å·¥å…· | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| **Android Studio** | Giraffe 2022.3.1+ | IDE |
| **Gradle** | 8.1.2 | æ„å»ºç³»ç»Ÿ |
| **CMake** | 4.1.0 | Nativeæ„å»º |
| **NDK** | 23.1.7779620 | Nativeå¼€å‘ |
| **Kotlin** | 1.8.10 | ä¸»å¼€å‘è¯­è¨€ |
| **Java** | 17 | JDKç‰ˆæœ¬ |

---

### AndroidæŠ€æœ¯æ ˆ

#### æ ¸å¿ƒæ¡†æ¶

```
AndroidX
â”œâ”€ androidx.core:core-ktx:1.12.0 (Kotlinæ‰©å±•)
â”œâ”€ androidx.appcompat:appcompat:1.2.0 (å…¼å®¹æ€§æ”¯æŒ)
â”œâ”€ androidx.activity:activity-ktx:1.7.2 (Activity KTX)
â”œâ”€ androidx.fragment (Fragmentæ”¯æŒ)
â””â”€ androidx.constraintlayout:constraintlayout:2.1.1 (çº¦æŸå¸ƒå±€)
```

#### UIç»„ä»¶

```
Material Design
â”œâ”€ com.google.android.material:material:1.4.0
â””â”€ ä½¿ç”¨ç»„ä»¶: Button, EditText, RecyclerViewç­‰
```

#### å›¾å½¢æ¸²æŸ“

```
OpenGL ES 2.0
â”œâ”€ GLSurfaceView (ç³»ç»Ÿè‡ªå¸¦)
â”œâ”€ TextureView (æ”¯æŒé€æ˜èƒŒæ™¯)
â”œâ”€ EGLé…ç½®: RGBA_8888, Depth 16
â””â”€ Shader: GLSL ES 2.0
```

---

### NativeæŠ€æœ¯æ ˆ

#### C++æ ‡å‡†

```
C++ 17
â”œâ”€ ç¼–è¯‘é€‰é¡¹: -std=c++17
â”œâ”€ ç‰¹æ€§: auto, lambda, smart pointers
â””â”€ å¼‚å¸¸æ”¯æŒ: -fexceptions
```

#### AI/MLæ¡†æ¶

```
NCNN (ç¥ç»ç½‘ç»œ)
â”œâ”€ ç‰ˆæœ¬: 20231027
â”œâ”€ æ¶æ„: arm64-v8a, armeabi-v7a
â”œâ”€ ç‰¹æ€§: Vulkanæ”¯æŒ
â””â”€ ç”¨é€”: ä¸»è¦æ¨ç†å¼•æ“

ONNX Runtime
â”œâ”€ ç”¨é€”: ONNXæ¨¡å‹è¿è¡Œæ—¶
â”œâ”€ æ ¼å¼: .onnxæ¨¡å‹
â””â”€ é›†æˆ: åŠ¨æ€é“¾æ¥

WeNet (è¯­éŸ³è¯†åˆ«)
â””â”€ ç”¨é€”: éŸ³é¢‘ç‰¹å¾å¢å¼º
```

#### å›¾åƒå¤„ç†

```
OpenCV Mobile
â”œâ”€ ç‰ˆæœ¬: 4.6.0
â”œâ”€ æ¨¡å—: core, imgproc, highgui
â””â”€ ç”¨é€”: å›¾åƒå˜æ¢ã€è‰²å½©è½¬æ¢

TurboJPEG
â””â”€ ç”¨é€”: é«˜æ€§èƒ½JPEGç¼–è§£ç 
```

#### éŸ³é¢‘å¤„ç†

```
è‡ªç ”éŸ³é¢‘å¤„ç†
â”œâ”€ AudioFFT: FFTå˜æ¢
â”œâ”€ MFCC: Melé¢‘ç‡å€’è°±ç³»æ•°
â”œâ”€ IIR Filter: æ»¤æ³¢å™¨
â””â”€ PCM: 16kHz, 16bit, Mono
```

---

### ç¬¬ä¸‰æ–¹åº“

#### Java/Kotlin

```gradle
// å›¾ç‰‡åŠ è½½
implementation 'com.github.bumptech.glide:glide:4.12.0'

// ç½‘ç»œè¯·æ±‚
implementation 'com.squareup.okhttp3:okhttp:4.10.0'
```

#### Native

```cmake
# ç¥ç»ç½‘ç»œ
find_package(ncnn REQUIRED)
target_link_libraries(gjduix ncnn)

# å›¾åƒå¤„ç†
find_package(OpenCV REQUIRED core imgproc)
target_link_libraries(gjduix ${OpenCV_LIBS})

# ONNX
add_library(onnx-lib SHARED IMPORTED)
target_link_libraries(gjduix onnx-lib)

# JPEG
target_link_libraries(gjduix turbojpeg libjpeg)
```

---

### æ¶æ„æ¨¡å¼

```
åº”ç”¨å±‚:
â”œâ”€ MVC (éƒ¨åˆ†Activity)
â””â”€ MVP (éƒ¨åˆ†Dialog)

SDKå±‚:
â”œâ”€ è§‚å¯Ÿè€…æ¨¡å¼ (Callback)
â”œâ”€ å•ä¾‹æ¨¡å¼ (DUIXRenderer, LanguageManager)
â”œâ”€ å·¥å‚æ¨¡å¼ (VirtualModelUtil)
â”œâ”€ ç­–ç•¥æ¨¡å¼ (RenderSink)
â””â”€ æ§åˆ¶å™¨æ¨¡å¼ (DUIXAudioController, DUIXMotionController) â† 2025-10-02æ–°å¢

Nativeå±‚:
â”œâ”€ ç®¡é“æ¨¡å¼ (éŸ³é¢‘å¤„ç†é“¾)
â”œâ”€ ç”Ÿäº§è€…-æ¶ˆè´¹è€… (éŸ³é¢‘é˜Ÿåˆ—)
â””â”€ å¯¹è±¡æ± æ¨¡å¼ (å†…å­˜ç®¡ç†)
```

---

### å¹¶å‘æ¨¡å‹

```
Javaå±‚:
â”œâ”€ ExecutorService (çº¿ç¨‹æ± )
â”œâ”€ HandlerThread (åå°çº¿ç¨‹)
â””â”€ RenderThread (è‡ªå®šä¹‰æ¸²æŸ“çº¿ç¨‹)

Nativeå±‚:
â”œâ”€ std::thread (C++çº¿ç¨‹)
â”œâ”€ pthread (POSIXçº¿ç¨‹)
â””â”€ æ— é”é˜Ÿåˆ— (ConcurrentQueue)
```

---

## æ„å»ºä¸éƒ¨ç½²

### å¼€å‘ç¯å¢ƒé…ç½®

#### 1. å¿…éœ€å·¥å…·

```bash
# æ£€æŸ¥ç¯å¢ƒ
java -version          # éœ€è¦JDK 17
cmake --version        # éœ€è¦CMake 3.18.1+
ndk-build --version    # NDK 23.1.7779620

# Android Studioé…ç½®
File -> Settings -> Build, Execution, Deployment
  -> Gradle
    -> Gradle JDK: é€‰æ‹©JDK 17
```

#### 2. NDKé…ç½®

```bash
# åœ¨local.propertiesä¸­é…ç½®NDKè·¯å¾„
ndk.dir=C\:\\Users\\<username>\\AppData\\Local\\Android\\Sdk\\ndk\\23.1.7779620

# æˆ–ä½¿ç”¨ç¯å¢ƒå˜é‡
export ANDROID_NDK_HOME=/path/to/ndk/23.1.7779620
```

#### 3. ä¾èµ–é…ç½®

é¡¹ç›®ä½¿ç”¨é˜¿é‡Œäº‘Mavené•œåƒåŠ é€Ÿï¼š

```gradle
// build.gradle (æ ¹çº§)
repositories {
    maven { url 'https://maven.aliyun.com/repository/public/' }
    maven { url 'https://maven.aliyun.com/repository/google' }
    google()
}
```

---

### æ„å»ºå‘½ä»¤

#### 1. æ¸…ç†é¡¹ç›®

```bash
./gradlew clean
```

#### 2. æ„å»ºSDK (AAR)

```bash
# Debugç‰ˆæœ¬
./gradlew :duix-sdk:assembleDebug

# Releaseç‰ˆæœ¬
./gradlew :duix-sdk:assembleRelease

# è¾“å‡ºè·¯å¾„
duix-sdk/build/outputs/aar/duix_client_sdk_release_4.1.1.aar
```

#### 3. æ„å»ºæµ‹è¯•åº”ç”¨

```bash
# Debug APK
./gradlew :test:assembleDebug

# Release APK (å·²ç­¾å)
./gradlew :test:assembleRelease

# è¾“å‡ºè·¯å¾„
test/build/outputs/apk/release/duix_mobile_test_release_<timestamp>_4.1.1.apk
```

#### 4. å®‰è£…æµ‹è¯•åº”ç”¨

```bash
# å®‰è£…Debugç‰ˆæœ¬
./gradlew :test:installDebug

# æˆ–ç›´æ¥å®‰è£…
adb install test/build/outputs/apk/debug/test-debug.apk
```

#### 5. ä»£ç æ£€æŸ¥

```bash
# Lintæ£€æŸ¥
./gradlew lint

# LintæŠ¥å‘Š
test/build/reports/lint-results.html
```

---

### ç­¾åé…ç½®

#### Releaseç­¾å

**æ–‡ä»¶**: `test/build.gradle`

```gradle
signingConfigs {
    release {
        storeFile file('../demo.jks')
        storePassword '123456'
        keyAlias 'demo'
        keyPassword '123456'
    }
}
```

**âš ï¸ ç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ä¸ºè‡ªå·±çš„ç­¾åæ–‡ä»¶ï¼**

---

### ProGuardæ··æ·†

#### å¿…éœ€çš„æ··æ·†è§„åˆ™

**æ–‡ä»¶**: `duix-sdk/proguard-rules.pro`

```proguard
# ä¿ç•™JNIæ¥å£
-keep class ai.guiji.duix.DuixNcnn { *; }

# ä¿ç•™å…¬å¼€API
-keep public class ai.guiji.duix.sdk.client.DUIX { *; }
-keep public class ai.guiji.duix.sdk.client.** { *; }

# ä¿ç•™å›è°ƒæ¥å£
-keep interface ai.guiji.duix.sdk.client.Callback { *; }

# ä¿ç•™å›½é™…åŒ–ç®¡ç†å™¨
-keep class ai.guiji.duix.sdk.i18n.LanguageManager { *; }
-keep class ai.guiji.duix.sdk.i18n.LanguageManager$Language { *; }

# ä¿ç•™Nativeæ–¹æ³•
-keepclasseswithmembernames class * {
    native <methods>;
}
```

---

### Nativeæ„å»º

#### CMakeé…ç½®

**æ–‡ä»¶**: `duix-sdk/src/main/cpp/CMakeLists.txt`

```cmake
cmake_minimum_required(VERSION 3.13.2)
project(gjmywrt)

# C++æ ‡å‡†
set(CMAKE_CXX_STANDARD 17)

# ç¼–è¯‘é€‰é¡¹
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -std=c++17 -fPIC -funwind-tables")

# æ¶æ„è¿‡æ»¤
abiFilters 'arm64-v8a', 'armeabi-v7a'

# é“¾æ¥åº“
target_link_libraries(gjduix
    dhcore dhmfcc dhunet
    ${OpenCV_LIBS}
    ncnn
    onnx-lib
    turbojpeg libjpeg
    -lz -lm -landroid
)
```

#### æ”¯æŒçš„ABI

```
arm64-v8a      # 64ä½ARM (ä¸»æµ)
armeabi-v7a    # 32ä½ARM (å…¼å®¹)
```

**æ³¨æ„**: ä¸æ”¯æŒx86/x86_64æ¨¡æ‹Ÿå™¨

---

### ç‰ˆæœ¬ç®¡ç†

**æ–‡ä»¶**: `build.gradle` (æ ¹çº§)

```gradle
ext {
    versionCode = 13        // æ¯æ¬¡å‘å¸ƒé€’å¢
    versionName = "4.1.1"   // è¯­ä¹‰åŒ–ç‰ˆæœ¬
}
```

---

### å‘å¸ƒæµç¨‹

#### å‘å¸ƒæ£€æŸ¥æ¸…å•

- [ ] æ›´æ–°ç‰ˆæœ¬å·
- [ ] è¿è¡Œæ‰€æœ‰æµ‹è¯•
- [ ] æ‰§è¡ŒLintæ£€æŸ¥
- [ ] æ„å»ºReleaseç‰ˆæœ¬
- [ ] æµ‹è¯•Release APK
- [ ] ç”ŸæˆAARæ–‡ä»¶
- [ ] æ›´æ–°CHANGELOG
- [ ] æ›´æ–°é¡¹ç›®è¯´æ˜.md
- [ ] æ‰“Gitæ ‡ç­¾
- [ ] å‘å¸ƒåˆ°GitHub Releases

#### å‘å¸ƒå‘½ä»¤

```bash
# 1. æ¸…ç†
./gradlew clean

# 2. æ„å»ºRelease
./gradlew assembleRelease

# 3. æ‰“æ ‡ç­¾
git tag -a v4.1.1 -m "Release version 4.1.1"
git push origin v4.1.1

# 4. å‘å¸ƒåˆ°GitHub Releases
# ä¸Šä¼ æ–‡ä»¶:
# - duix-sdk/build/outputs/aar/*.aar
# - test/build/outputs/apk/release/*.apk
```

---

## é™„å½•

### å¸¸ç”¨æ–‡ä»¶è·¯å¾„é€ŸæŸ¥

```
SDKæ ¸å¿ƒ:
- DUIXä¸»ç±»: duix-sdk/src/main/java/ai/guiji/duix/sdk/client/DUIX.java
- æ¸²æŸ“çº¿ç¨‹: duix-sdk/src/main/java/ai/guiji/duix/sdk/client/thread/RenderThread.java
- æ¸²æŸ“å™¨: duix-sdk/src/main/java/ai/guiji/duix/sdk/client/render/DUIXRenderer.java
- è¯­è¨€ç®¡ç†: duix-sdk/src/main/java/ai/guiji/duix/sdk/i18n/LanguageManager.kt
- JNIæ¥å£: duix-sdk/src/main/java/ai/guiji/duix/DuixNcnn.java
- Nativeå…¥å£: duix-sdk/src/main/cpp/android/DuixJni.cpp
- DUIXæ ¸å¿ƒ: duix-sdk/src/main/cpp/duix/gjduix.cpp

åº”ç”¨å…¥å£:
- Application: test/src/main/java/ai/guiji/duix/test/App.java
- ä¸»ç•Œé¢: test/src/main/java/ai/guiji/duix/test/ui/activity/MainActivity.kt
- æœ¬åœ°é…ç½®: test/src/main/java/ai/guiji/duix/test/ui/activity/local/LocalMainActivity.kt
- æœ¬åœ°æ’­æ”¾: test/src/main/java/ai/guiji/duix/test/ui/activity/local/LocalCallActivity.kt
- äº‘ç«¯ç•Œé¢: test/src/main/java/ai/guiji/duix/test/ui/activity/cloud/CloudMainActivity.kt

æ„å»ºé…ç½®:
- æ ¹æ„å»º: build.gradle
- SDKæ„å»º: duix-sdk/build.gradle
- Appæ„å»º: test/build.gradle
- CMake: duix-sdk/src/main/cpp/CMakeLists.txt
```

---

### å…³é”®APIé€ŸæŸ¥

#### DUIXæ ¸å¿ƒAPI

```java
// åˆå§‹åŒ–
DUIX duix = new DUIX(context, modelUrl, renderSink, callback);
duix.init();

// éŸ³é¢‘æ’­æ”¾
duix.playAudio(wavPath);  // WAVæ–‡ä»¶
duix.startPush();         // PCMæµå¼€å§‹
duix.pushPcm(pcmData);    // æ¨é€PCM
duix.stopPush();          // PCMæµç»“æŸ
duix.stopAudio();         // åœæ­¢æ’­æ”¾

// åŠ¨ä½œæ§åˆ¶
duix.startMotion("smile", true);  // æŒ‡å®šåŠ¨ä½œ
duix.startRandomMotion(true);      // éšæœºåŠ¨ä½œ

// éŸ³é‡æ§åˆ¶
duix.setVolume(0.5f);  // 0.0 ~ 1.0

// é‡Šæ”¾èµ„æº
duix.release();
```

#### å›è°ƒäº‹ä»¶

```java
callback.onEvent(event, msg, info);

// äº‹ä»¶ç±»å‹
CALLBACK_EVENT_INIT_READY         // å°±ç»ª
CALLBACK_EVENT_INIT_ERROR         // åˆå§‹åŒ–é”™è¯¯
CALLBACK_EVENT_AUDIO_PLAY_START   // æ’­æ”¾å¼€å§‹
CALLBACK_EVENT_AUDIO_PLAY_END     // æ’­æ”¾ç»“æŸ
CALLBACK_EVENT_AUDIO_PLAY_ERROR   // æ’­æ”¾é”™è¯¯
CALLBACK_EVENT_MOTION_START       // åŠ¨ä½œå¼€å§‹
CALLBACK_EVENT_MOTION_END         // åŠ¨ä½œç»“æŸ
```

#### æ¨¡å‹ç®¡ç†API

```java
// æ£€æŸ¥æ¨¡å‹
boolean hasBase = VirtualModelUtil.checkBaseConfig(context);
boolean hasModel = VirtualModelUtil.checkModel(context, modelUrl);

// ä¸‹è½½æ¨¡å‹
VirtualModelUtil.modelDownload(context, modelUrl, new ModelDownloadCallback() {
    void onDownloadProgress(String url, long current, long total) { }
    void onUnzipProgress(String url, long current, long total) { }
    void onDownloadComplete(String url, File dir) { }
    void onDownloadFail(String url, int code, String msg) { }
});
```

#### è¯­è¨€ç®¡ç†API (2025-10-02æ–°å¢)

```kotlin
// è·å–å½“å‰è¯­è¨€
val currentLang = LanguageManager.getCurrentLanguage(context)

// è®¾ç½®è¯­è¨€
LanguageManager.setLanguage(context, LanguageManager.Language.ENGLISH)

// åº”ç”¨è¯­è¨€åˆ°Context
override fun attachBaseContext(newBase: Context) {
    super.attachBaseContext(LanguageManager.applyLanguage(newBase))
}
```

---

### å¸¸è§é—®é¢˜æ’æŸ¥

| é—®é¢˜ | å¯èƒ½åŸå›  | è§£å†³æ–¹æ¡ˆ |
|------|---------|---------|
| åˆå§‹åŒ–å¤±è´¥ | æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨ | æ£€æŸ¥ `/duix/model/` ç›®å½•ï¼Œé‡æ–°ä¸‹è½½æ¨¡å‹ |
| æ¸²æŸ“é»‘å± | EGLé…ç½®é”™è¯¯ | ç¡®ä¿è®¾ç½®äº† `setEGLConfigChooser(8, 8, 8, 8, 16, 0)` |
| éŸ³é¢‘æ— å£° | éŸ³é‡è®¾ç½®ä¸º0 | è°ƒç”¨ `duix.setVolume(1.0f)` |
| å£å‹ä¸åŠ¨ | éŸ³é¢‘æ ¼å¼é”™è¯¯ | ç¡®ä¿PCM: 16kHz, 16bit, Mono |
| ç¼–è¯‘é”™è¯¯ | JDKç‰ˆæœ¬ä¸å¯¹ | ä½¿ç”¨JDK 17 |
| NDKé”™è¯¯ | NDKç‰ˆæœ¬ä¸åŒ¹é… | ä½¿ç”¨ NDK 23.1.7779620 |
| è¯­è¨€æœªåˆ‡æ¢ | æœªé‡å¯Activity | è°ƒç”¨ `recreate()` é‡å¯Activity |

---

### æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **å†…å­˜ä¼˜åŒ–**
   - åŠæ—¶è°ƒç”¨ `duix.release()` é‡Šæ”¾èµ„æº
   - ä½¿ç”¨å¯¹è±¡æ± å¤ç”¨éŸ³é¢‘ç¼“å†²åŒº
   - é¿å…åœ¨ä¸»çº¿ç¨‹æ‰§è¡Œè€—æ—¶æ“ä½œ

2. **æ¸²æŸ“ä¼˜åŒ–**
   - ä½¿ç”¨ `RENDERMODE_WHEN_DIRTY` æ¨¡å¼
   - å‡å°‘ä¸å¿…è¦çš„ `requestRender()` è°ƒç”¨
   - ä¼˜åŒ–çº¹ç†å°ºå¯¸

3. **éŸ³é¢‘ä¼˜åŒ–**
   - ä½¿ç”¨æµå¼æ¨é€è€Œéä¸€æ¬¡æ€§åŠ è½½
   - æ§åˆ¶éŸ³é¢‘é˜Ÿåˆ—é•¿åº¦
   - åŠæ—¶æ¸…ç†éŸ³é¢‘ç¼“å­˜

4. **æ¨¡å‹ä¼˜åŒ–**
   - ä½¿ç”¨é‡åŒ–æ¨¡å‹å‡å°ä½“ç§¯
   - é¢„åŠ è½½å¸¸ç”¨æ¨¡å‹
   - å¼‚æ­¥åŠ è½½æ¨¡å‹æ–‡ä»¶

---

### è”ç³»ä¸æ”¯æŒ

- **GitHub**: [duixcom/Duix-Mobile](https://github.com/duixcom/Duix-Mobile)
- **é—®é¢˜åé¦ˆ**: GitHub Issues
- **æ–‡æ¡£**: README.md

---

## æ›´æ–°æ—¥å¿—

### v4.1.1 (2025-10-02)

#### æ–°å¢åŠŸèƒ½
- âœ… **å®Œæ•´å›½é™…åŒ–ç³»ç»Ÿ**
  - æ–°å¢ `LanguageManager` è¯­è¨€ç®¡ç†å™¨
  - æ”¯æŒä¸­è‹±æ–‡åŒè¯­åˆ‡æ¢
  - æ¬¢è¿é¡µå›½é™…åŒ–æ”¯æŒï¼ˆi18n.jsï¼‰
  - æ–°å¢ `LanguageSelectorDialog` è¯­è¨€é€‰æ‹©å¯¹è¯æ¡†
  - æ–°å¢ `values-en/strings.xml` è‹±æ–‡èµ„æºæ–‡ä»¶

#### æ¶æ„ä¼˜åŒ–
- âœ… **DUIXè§£è€¦é‡æ„**
  - æ‹†åˆ†ä¸º `DUIXInitializer`, `DUIXAudioController`, `DUIXMotionController`
  - é‡‡ç”¨æ§åˆ¶å™¨æ¨¡å¼ï¼Œå•ä¸€èŒè´£åŸåˆ™
  - æå‡ä»£ç å¯æµ‹è¯•æ€§å’Œå¯ç»´æŠ¤æ€§

- âœ… **æœ¬åœ°/äº‘ç«¯æ¨¡å—åˆ†ç¦»**
  - æ–°å¢ `local` åŒ…ï¼ˆLocalMainActivity, LocalCallActivityï¼‰
  - æ–°å¢ `cloud` åŒ…ï¼ˆCloudMainActivityï¼‰
  - æ¸…æ™°çš„æ¨¡å—è¾¹ç•Œ

#### UIæ”¹è¿›
- âœ… **æœ¬åœ°æ•°å­—äººç•Œé¢æ¨¡å—åŒ–æ”¹é€ **
  - ç°ä»£åŒ–UIè®¾è®¡ï¼ˆæ¸å˜æŒ‰é’®ã€åœ†è§’è¾“å…¥æ¡†ï¼‰
  - å¯¹è¯æ¡†æ›¿ä»£ä¸‹æ‹‰æ¡†
  - å¯æŠ˜å é«˜çº§è®¾ç½®é¢æ¿
  - ç®€åŒ–é…ç½®æµç¨‹

- âœ… **æ¬¢è¿é¡µç¾åŒ–å‡çº§**
  - åŠ¨æ€æ¸å˜èƒŒæ™¯ï¼ˆ15ç§’å¾ªç¯ï¼‰
  - æ¯›ç»ç’ƒå¡ç‰‡æ•ˆæœ
  - æ°´æ³¢çº¹æ‰©æ•£åŠ¨ç”»
  - å“åº”å¼è®¾è®¡
  - å›½é™…åŒ–æ”¯æŒ

#### Bugä¿®å¤
- âœ… ä¿®å¤è¯­è¨€åˆ‡æ¢åŠŸèƒ½
- âœ… ä¿®å¤æ¬¢è¿é¡µæ ‡é¢˜ä½ç½®
- âœ… ä¿®å¤ä¸‹æ‹‰èœå•ä½ç½®
- âœ… ä¿®å¤åº”ç”¨é—ªé€€é—®é¢˜
- âœ… ä¿®å¤è¿”å›æŒ‰é’®ä½ç½®

#### æ–‡æ¡£æ›´æ–°
- âœ… æ›´æ–°é¡¹ç›®è¯´æ˜.mdï¼ˆåŸºäºRepomixåˆ†æï¼‰
- âœ… æ–°å¢17ç¯‡å¼€å‘æ–‡æ¡£è®°å½•
- âœ… å®Œå–„å›½é™…åŒ–ç³»ç»Ÿæ–‡æ¡£
- âœ… æ›´æ–°æ¶æ„è®¾è®¡æ–‡æ¡£

---

### v4.1.0 (2025-10-01)

#### é…ç½®ä¼˜åŒ–
- âœ… Gradleå†…å­˜é…ç½®ä¼˜åŒ–
- âœ… å®¶åº­ç¯å¢ƒç¼–è¯‘é…ç½®
- âœ… NDKç‰ˆæœ¬å›ºå®šä¸º23.1.7779620

---

### v4.0.0 (2025-09-30)

#### æ–°å¢åŠŸèƒ½
- âœ… æ¬¢è¿é¡µé¢åŠŸèƒ½å®ç°
- âœ… æ¬¢è¿é¡µé¢ä¸“ä¸šç¾åŒ–
- âœ… æ•°å­—äººåœæ­¢æ’­æ”¾æŒ‰é’®

#### Bugä¿®å¤
- âœ… ç¼–è¯‘é”™è¯¯ä¿®å¤

---

**æ–‡æ¡£ç»“æŸ**

æœ¬æ–‡æ¡£ç”± Claude AI åŸºäº Repomix æ‰“åŒ…çš„ä»£ç åº“ï¼ˆoutputId: 3426f7442ef9af68ï¼‰è‡ªåŠ¨ç”Ÿæˆã€‚
é¡¹ç›®éµå¾ªä¸¥æ ¼çš„ä»£ç è§„èŒƒå’Œæ¶æ„è®¾è®¡åŸåˆ™ã€‚
æœ€åæ›´æ–°: 2025-10-02
